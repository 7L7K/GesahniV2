{
  "openapi": "3.1.0",
  "info": {
    "title": "GesahniV2",
    "description": "GesahniV2 API",
    "version": "v0.6.5-9-g4d8d69b2"
  },
  "paths": {
    "/v1/ask": {
      "post": {
        "tags": [
          "Care"
        ],
        "summary": " Ask",
        "description": "Internal ask function that accepts resolved user_id parameter.",
        "operationId": "_ask_v1_ask_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AskRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "example": {
                    "status": "ok"
                  }
                }
              },
              "text/plain": {
                "schema": {
                  "example": "hello world"
                }
              },
              "text/event-stream": {
                "schema": {
                  "example": "data: hello\n\n"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/login": {
      "post": {
        "tags": [
          "Auth",
          "Auth"
        ],
        "summary": "Login",
        "description": "Dev login scaffold.\n\n    CSRF: Required when CSRF_ENABLED=1 via X-CSRF-Token header (header-token service).\n    Rotates CSRF token on successful login.\n    \n\n@public_route - No auth, no CSRF required",
        "operationId": "login_v1_auth_login_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoginOut",
                  "example": {
                    "status": "ok",
                    "user_id": "dev"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/register": {
      "post": {
        "tags": [
          "Auth",
          "Auth"
        ],
        "summary": "Register V1",
        "description": "Create a local account and return tokens.\n\n@public_route - No auth, no CSRF required",
        "operationId": "register_v1_v1_auth_register_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegisterOut",
                  "example": {
                    "access_token": "jwt",
                    "refresh_token": "jwt"
                  }
                }
              }
            }
          },
          "400": {
            "description": "ERR_INVALID or username_taken"
          }
        }
      }
    },
    "/v1/auth/refresh": {
      "post": {
        "tags": [
          "Auth",
          "Auth"
        ],
        "summary": "Refresh",
        "description": "Rotate access/refresh cookies.",
        "operationId": "refresh_v1_auth_refresh_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RefreshOut",
                  "example": {
                    "rotated": false
                  }
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/logout": {
      "post": {
        "tags": [
          "Auth",
          "Auth"
        ],
        "summary": "Logout",
        "description": "Logout user and clear all session data.\n\n@auth_only_route - Auth token required, CSRF not required",
        "operationId": "logout_v1_auth_logout_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "204": {
            "description": "Logout successful"
          }
        }
      }
    },
    "/v1/auth/logout_all": {
      "post": {
        "tags": [
          "Auth",
          "Auth"
        ],
        "summary": "Logout All",
        "description": "Logout from all sessions in this family.\n\n@auth_only_route - Auth token required, CSRF not required",
        "operationId": "logout_all_v1_auth_logout_all_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "204": {
            "description": "Logout all sessions for this family"
          }
        }
      }
    },
    "/v1/auth/revoke": {
      "post": {
        "tags": [
          "Auth",
          "Auth"
        ],
        "summary": "Revoke",
        "description": "Revoke sessions or tokens. Idempotent operation that always returns 204.\n\nCan revoke by:\n- sid: Revoke specific session\n- user_id: Revoke all sessions for user\n- jti: Blacklist specific JWT token",
        "operationId": "revoke_v1_auth_revoke_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevokeReq"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "Revocation successful"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/token": {
      "post": {
        "tags": [
          "Auth",
          "Auth"
        ],
        "summary": "Dev Token",
        "operationId": "dev_token_v1_auth_token_post",
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/Body_dev_token_v1_auth_token_post"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/examples": {
      "get": {
        "tags": [
          "Auth",
          "Auth"
        ],
        "summary": "Token Examples",
        "operationId": "token_examples_v1_auth_examples_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenExamplesOut"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/v1/auth/cookie-config": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Get Cookie Config Info",
        "description": "Get current cookie configuration for debugging.",
        "operationId": "get_cookie_config_info_v1_auth_v1_auth_cookie_config_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/auth/v1/auth/jwt-info": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Get Jwt Info",
        "description": "Get JWT token information for debugging.",
        "operationId": "get_jwt_info_v1_auth_v1_auth_jwt_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/auth/v1/auth/session-info": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Get Session Info",
        "description": "Get session information for debugging.",
        "operationId": "get_session_info_v1_auth_v1_auth_session_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/auth/v1/auth/refresh-info": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Get Refresh Info",
        "description": "Get refresh token information for debugging.",
        "operationId": "get_refresh_info_v1_auth_v1_auth_refresh_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/auth/v1/auth/env-info": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Get Env Info",
        "description": "Get environment and configuration information for debugging.",
        "operationId": "get_env_info_v1_auth_v1_auth_env_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/auth/v1/auth/csrf-info": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Get Csrf Info",
        "description": "Get CSRF token information for debugging.",
        "operationId": "get_csrf_info_v1_auth_v1_auth_csrf_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/auth/v1/auth/comprehensive": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Get Comprehensive Auth Info",
        "description": "Get comprehensive authentication information in a single request.",
        "operationId": "get_comprehensive_auth_info_v1_auth_v1_auth_comprehensive_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/auth/cookie-config": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Debug Cookie Config",
        "description": "Return cookie configuration for frontend debugging.",
        "operationId": "debug_cookie_config_v1_auth_cookie_config_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Debug Cookie Config V1 Auth Cookie Config Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/session-info": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Debug Session Info",
        "description": "Return session information for frontend debugging.",
        "operationId": "debug_session_info_v1_auth_session_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Debug Session Info V1 Auth Session Info Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/jwt-info": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Debug Jwt Info",
        "description": "Return JWT token information for frontend debugging.",
        "operationId": "debug_jwt_info_v1_auth_jwt_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Debug Jwt Info V1 Auth Jwt Info Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/refresh-info": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Debug Refresh Info",
        "description": "Return refresh token status for frontend debugging.",
        "operationId": "debug_refresh_info_v1_auth_refresh_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Debug Refresh Info V1 Auth Refresh Info Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/env-info": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Debug Env Info",
        "description": "Return auth-related environment configuration.",
        "operationId": "debug_env_info_v1_auth_env_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Debug Env Info V1 Auth Env Info Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/whoami": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Auth Whoami Endpoint",
        "description": "Main whoami endpoint for authentication checking.",
        "operationId": "auth_whoami_endpoint_v1_auth_whoami_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Auth Whoami Endpoint V1 Auth Whoami Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/pats": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "List Pats",
        "operationId": "list_pats_v1_pats_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": {
                    "items": {
                      "additionalProperties": true,
                      "type": "object"
                    },
                    "type": "array"
                  },
                  "type": "object",
                  "title": "Response List Pats V1 Pats Get"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Create Pat",
        "operationId": "create_pat_v1_pats_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Body"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/pats/{pat_id}": {
      "delete": {
        "tags": [
          "Auth"
        ],
        "summary": "Revoke Pat",
        "operationId": "revoke_pat_v1_pats__pat_id__delete",
        "parameters": [
          {
            "name": "pat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Pat Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  },
                  "title": "Response Revoke Pat V1 Pats  Pat Id  Delete"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/auth/finish": {
      "get": {
        "summary": "Auth Finish Get",
        "description": "OAuth finisher endpoint that sets auth cookies after OAuth callback.\n\nThis endpoint is called after OAuth callback processing to set the final\nauth cookies and redirect to the application.",
        "operationId": "auth_finish_get_auth_finish_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/google/connect": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Google Connect",
        "description": "Compatibility endpoint: return authorize_url and set state cookie.\n\nBridges to app.api.google_oauth.google_login_url, which sets the OAuth\nstate cookie. Adapts the response body key to \"authorize_url\" expected by\ntests and legacy clients.",
        "operationId": "google_connect_v1_google_connect_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/calendar/today": {
      "get": {
        "tags": [
          "Calendar"
        ],
        "summary": "List Today",
        "operationId": "list_today_v1_calendar_today_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EventsResponse"
                },
                "example": {
                  "items": [
                    {
                      "date": "2025-08-12",
                      "time": "09:30",
                      "title": "Doctor appointment",
                      "location": "Clinic"
                    },
                    {
                      "date": "2025-08-12",
                      "time": "13:00",
                      "title": "Lunch with Sam",
                      "location": "Cafe"
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/calendar/next": {
      "get": {
        "tags": [
          "Calendar"
        ],
        "summary": "Next Three",
        "operationId": "next_three_v1_calendar_next_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EventsResponse"
                },
                "example": {
                  "items": [
                    {
                      "date": "2025-08-12",
                      "time": "09:30",
                      "title": "Doctor appointment"
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/calendar/list": {
      "get": {
        "tags": [
          "Calendar"
        ],
        "summary": "List All",
        "operationId": "list_all_v1_calendar_list_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EventsResponse"
                },
                "example": {
                  "items": [
                    {
                      "date": "2025-08-12",
                      "time": "09:30",
                      "title": "Doctor appointment"
                    },
                    {
                      "date": "2025-08-13",
                      "time": "10:00",
                      "title": "Grocery pickup"
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/reminders": {
      "get": {
        "tags": [
          "Calendar"
        ],
        "summary": "List Reminders",
        "description": "List reminders with pagination caps.\n\nEnforces pagination caps:\n- Maximum 100 reminders per request",
        "operationId": "list_reminders_v1_reminders_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "Maximum number of reminders to return (1-100)",
              "default": 100,
              "title": "Limit"
            },
            "description": "Maximum number of reminders to return (1-100)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Calendar"
        ],
        "summary": "Add Reminder",
        "operationId": "add_reminder_v1_reminders_post",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReminderCreate",
                "allOf": [
                  {
                    "$ref": "#/components/schemas/ReminderCreate"
                  }
                ],
                "example": {
                  "text": "Take meds",
                  "when": "2025-01-01T09:00:00Z",
                  "channel": "sms"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Calendar"
        ],
        "summary": "Clear Reminders",
        "operationId": "clear_reminders_v1_reminders_delete",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/care/alerts": {
      "post": {
        "tags": [
          "Care"
        ],
        "summary": "Create Alert",
        "operationId": "create_alert_v1_care_alerts_post",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AlertCreate",
                "example": {
                  "resident_id": "r1",
                  "kind": "help",
                  "severity": "critical",
                  "note": "Grandma pressed the help button"
                }
              },
              "example": {
                "resident_id": "r1",
                "kind": "help",
                "severity": "critical",
                "note": "Grandma pressed the help button"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertRecord"
                }
              }
            }
          },
          "429": {
            "content": {
              "application/problem+json": {
                "example": {
                  "type": "about:blank",
                  "title": "Too Many Requests",
                  "status": 429,
                  "detail": {
                    "error": "rate_limited",
                    "retry_after": 29
                  },
                  "instance": "/v1/care/alerts",
                  "retry_after": 29
                }
              }
            },
            "description": "Too Many Requests"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "Care"
        ],
        "summary": "List Alerts",
        "operationId": "list_alerts_v1_care_alerts_get",
        "parameters": [
          {
            "name": "resident_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Resident Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/care/alerts/{alert_id}/ack": {
      "post": {
        "tags": [
          "Care"
        ],
        "summary": "Ack Alert",
        "operationId": "ack_alert_v1_care_alerts__alert_id__ack_post",
        "parameters": [
          {
            "name": "alert_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Alert Id"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "anyOf": [
                  {
                    "$ref": "#/components/schemas/AckBody"
                  },
                  {
                    "type": "null"
                  }
                ],
                "title": "Body",
                "example": {
                  "by": "cg1"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertRecord"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/care/alerts/{alert_id}/resolve": {
      "post": {
        "tags": [
          "Care"
        ],
        "summary": "Resolve Alert",
        "operationId": "resolve_alert_v1_care_alerts__alert_id__resolve_post",
        "parameters": [
          {
            "name": "alert_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Alert Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertRecord"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/care/devices/{device_id}/heartbeat": {
      "post": {
        "tags": [
          "Care"
        ],
        "summary": "Heartbeat",
        "operationId": "heartbeat_v1_care_devices__device_id__heartbeat_post",
        "parameters": [
          {
            "name": "device_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Device Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Heartbeat"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/care/device_status": {
      "get": {
        "tags": [
          "Care"
        ],
        "summary": "Device Status",
        "operationId": "device_status_v1_care_device_status_get",
        "parameters": [
          {
            "name": "device_id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Device Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Device Status V1 Care Device Status Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/care/sessions": {
      "post": {
        "tags": [
          "Care"
        ],
        "summary": "Create Care Session",
        "operationId": "create_care_session_v1_care_sessions_post",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SessionBody"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "Care"
        ],
        "summary": "List Care Sessions",
        "operationId": "list_care_sessions_v1_care_sessions_get",
        "parameters": [
          {
            "name": "resident_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Resident Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/care/sessions/{session_id}": {
      "patch": {
        "tags": [
          "Care"
        ],
        "summary": "Patch Care Session",
        "operationId": "patch_care_session_v1_care_sessions__session_id__patch",
        "parameters": [
          {
            "name": "session_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Session Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": true,
                "title": "Body"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/devices/pair/start": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Pair Start",
        "operationId": "pair_start_v1_devices_pair_start_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Pair Start V1 Devices Pair Start Post"
                }
              }
            }
          }
        }
      }
    },
    "/v1/devices/pair/complete": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Pair Complete",
        "operationId": "pair_complete_v1_devices_pair_complete_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Body"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Pair Complete V1 Devices Pair Complete Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/integrations/google/status": {
      "get": {
        "summary": "Integrations Google Status",
        "description": "Canonical Google status endpoint at /v1/integrations/google/status",
        "operationId": "integrations_google_status_v1_integrations_google_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/integrations/google/disconnect": {
      "post": {
        "summary": "Integrations Google Disconnect",
        "description": "Canonical Google disconnect endpoint at /v1/integrations/google/disconnect",
        "operationId": "integrations_google_disconnect_v1_integrations_google_disconnect_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/integrations/status": {
      "get": {
        "summary": "Integrations Status",
        "operationId": "integrations_status_v1_integrations_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/state": {
      "get": {
        "summary": "Get System State",
        "description": "Get system/app state at /v1/state",
        "operationId": "get_system_state_v1_state_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/tts/speak": {
      "post": {
        "tags": [
          "Music"
        ],
        "summary": "Speak",
        "operationId": "speak_v1_tts_speak_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TTSRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "TTS audio generated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TTSAck"
                }
              },
              "audio/wav": {
                "schema": {
                  "type": "string",
                  "format": "binary",
                  "description": "PCM WAV audio stream"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/transcribe/{session_id}": {
      "post": {
        "tags": [
          "Care"
        ],
        "summary": "Start Transcription",
        "operationId": "start_transcription_v1_transcribe__session_id__post",
        "parameters": [
          {
            "name": "session_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Session Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "Care"
        ],
        "summary": "Get Transcription",
        "operationId": "get_transcription_v1_transcribe__session_id__get",
        "parameters": [
          {
            "name": "session_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Session Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/ws/{path}": {
      "delete": {
        "tags": [],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws__path__delete",
        "parameters": [
          {
            "name": "path",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Path"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "patch": {
        "tags": [],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws__path__patch",
        "parameters": [
          {
            "name": "path",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Path"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws__path__put",
        "parameters": [
          {
            "name": "path",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Path"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws__path__post",
        "parameters": [
          {
            "name": "path",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Path"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws__path__get",
        "parameters": [
          {
            "name": "path",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Path"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/ws/music": {
      "get": {
        "tags": [
          "Music"
        ],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws_music_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Music"
        ],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws_music_put",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Music"
        ],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws_music_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Music"
        ],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws_music_delete",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "patch": {
        "tags": [
          "Music"
        ],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws_music_patch",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/ws/care": {
      "get": {
        "tags": [
          "Care"
        ],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws_care_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Care"
        ],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws_care_put",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Care"
        ],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws_care_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Care"
        ],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws_care_delete",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "patch": {
        "tags": [
          "Care"
        ],
        "summary": "Websocket Http Handler",
        "operationId": "websocket_http_handler_v1_ws_care_patch",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/ws/care/docs": {
      "get": {
        "tags": [
          "Care"
        ],
        "summary": "Ws Care Docs",
        "description": "WebSocket entry point documentation.\n\nConnect to ``/v1/ws/care`` and send a JSON message to subscribe to a topic.\nExample payload: ``{\"action\": \"subscribe\", \"topic\": \"resident:r1\"}``.",
        "operationId": "ws_care_docs_v1_ws_care_docs_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WSTopicsInfo"
                }
              }
            }
          }
        }
      }
    },
    "/v1/ha/entities": {
      "get": {
        "tags": [
          "Care"
        ],
        "summary": "Ha Entities",
        "operationId": "ha_entities_v1_ha_entities_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/ha/health": {
      "get": {
        "tags": [
          "Care"
        ],
        "summary": "Ha Health",
        "description": "Lightweight HA connectivity check.\n\nReturns 200 when the HA API responds; 500 on failure.",
        "operationId": "ha_health_v1_ha_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/ha/service": {
      "post": {
        "tags": [
          "Care"
        ],
        "summary": "Ha Service",
        "operationId": "ha_service_v1_ha_service_post",
        "parameters": [
          {
            "name": "args",
            "in": "query",
            "required": true,
            "schema": {
              "title": "Args"
            }
          },
          {
            "name": "kwargs",
            "in": "query",
            "required": true,
            "schema": {
              "title": "Kwargs"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ServiceRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceAck"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/ha/webhook": {
      "post": {
        "tags": [
          "Care"
        ],
        "summary": "Ha Webhook",
        "operationId": "ha_webhook_v1_ha_webhook_post",
        "parameters": [
          {
            "name": "x-signature",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Signature"
            }
          },
          {
            "name": "x-timestamp",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Timestamp"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookAck"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/ha/resolve": {
      "get": {
        "tags": [
          "Care"
        ],
        "summary": "Ha Resolve",
        "operationId": "ha_resolve_v1_ha_resolve_get",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Name"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/ping": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Ping",
        "description": "Enhanced admin ping endpoint using new RBAC system.\n\nThis endpoint demonstrates:\n- require_admin() dependency (accepts any admin scope)\n- get_user_scopes() dependency to access current user scopes\n- Structured response with RBAC information",
        "operationId": "admin_ping_v1_admin_ping_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminStatusResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        }
      }
    },
    "/v1/admin/rbac/info": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Rbac Info",
        "description": "Get RBAC information for the current user.\n\nThis endpoint demonstrates:\n- require_scope() dependency (requires exact scope)\n- get_user_scopes() to show current permissions\n- Information about available scopes and roles",
        "operationId": "admin_rbac_info_v1_admin_rbac_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RbacInfoResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        }
      }
    },
    "/v1/admin/users/me": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin User Profile",
        "description": "User profile endpoint accessible to any user with profile scope.\n\nThis demonstrates role-based access where different user types\ncan access their own profile information.",
        "operationId": "admin_user_profile_v1_admin_users_me_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        }
      }
    },
    "/v1/admin/system/status": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin System Status",
        "description": "System status endpoint for read-only admin access.\n\nThis demonstrates granular admin permissions where users with\nadmin:read can view status but not modify system settings.",
        "operationId": "admin_system_status_v1_admin_system_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        }
      }
    },
    "/v1/admin/tokens/google": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Tokens Google",
        "description": "Admin view: compact tokens for a given user_id (auth-gated).\n\nReturns a compact list of token rows (valid and invalid) for inspection.",
        "operationId": "admin_tokens_google_v1_admin_tokens_google_get",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "User Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/users/{user_id}/identities": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin User Identities",
        "description": "Return identities for a given user along with last token refresh info.\n\nRequires admin:read scope.",
        "operationId": "admin_user_identities_v1_admin_users__user_id__identities_get",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "User Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/users/{user_id}/identities/{identity_id}/unlink": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Unlink Identity",
        "description": "Unlink an identity from a user with safety guards.\n\nIf unlinking would remove the last usable login method for the user, require `force=true`.",
        "operationId": "admin_unlink_identity_v1_admin_users__user_id__identities__identity_id__unlink_post",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "User Id"
            }
          },
          {
            "name": "identity_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Identity Id"
            }
          },
          {
            "name": "force",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "boolean"
                },
                {
                  "type": "null"
                }
              ],
              "default": false,
              "title": "Force"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/surface/index": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Surface Index",
        "description": "Return a generated index of HTTP (OpenAPI) and WS routes to prevent drift.",
        "operationId": "admin_surface_index_v1_admin_surface_index_get",
        "parameters": [
          {
            "name": "token",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Token"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/metrics": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Metrics",
        "operationId": "admin_metrics_v1_admin_metrics_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Admin Metrics V1 Admin Metrics Get"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        }
      }
    },
    "/v1/admin/router/decisions": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Router Decisions",
        "operationId": "admin_router_decisions_v1_admin_router_decisions_get",
        "parameters": [
          {
            "name": "token",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Token"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 1000,
              "minimum": 1,
              "default": 500,
              "title": "Limit"
            }
          },
          {
            "name": "cursor",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0,
              "title": "Cursor"
            }
          },
          {
            "name": "engine",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Engine"
            }
          },
          {
            "name": "model",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Model"
            }
          },
          {
            "name": "cache_hit",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "boolean"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Cache Hit"
            }
          },
          {
            "name": "escalated",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "boolean"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Escalated"
            }
          },
          {
            "name": "intent",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Intent"
            }
          },
          {
            "name": "q",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Q"
            }
          },
          {
            "name": "since",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Since"
            }
          },
          {
            "name": "before",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Before"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Admin Router Decisions V1 Admin Router Decisions Get"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/router/decisions.ndjson": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Router Decisions Ndjson",
        "description": "Download last N router decisions as NDJSON (for audit pipelines).",
        "operationId": "admin_router_decisions_ndjson_v1_admin_router_decisions_ndjson_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 1000,
              "minimum": 1,
              "default": 500,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/retrieval/last": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Retrieval Last",
        "description": "Return last N retrieval traces (subset of router decisions), most recent first.",
        "operationId": "admin_retrieval_last_v1_admin_retrieval_last_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 2000,
              "minimum": 1,
              "default": 200,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/diagnostics/requests": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Diagnostics Requests",
        "description": "Return last N request IDs with timestamps for quick diagnostics.",
        "operationId": "admin_diagnostics_requests_v1_admin_diagnostics_requests_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 200,
              "minimum": 1,
              "default": 50,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Admin Diagnostics Requests V1 Admin Diagnostics Requests Get"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/decisions/explain": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Explain Decision",
        "operationId": "explain_decision_v1_admin_decisions_explain_get",
        "parameters": [
          {
            "name": "req_id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Req Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/config": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Config",
        "description": "Get admin configuration - requires admin:read scope",
        "operationId": "admin_config_v1_admin_config_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        }
      },
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Config Post",
        "description": "Minimal admin config POST endpoint for admin-write tests.",
        "operationId": "admin_config_post_v1_admin_config_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "anyOf": [
                  {
                    "additionalProperties": true,
                    "type": "object"
                  },
                  {
                    "type": "null"
                  }
                ],
                "title": "Payload"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/config/test": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Config Test",
        "description": "Test endpoint for admin write operations - requires admin:write scope",
        "operationId": "admin_config_test_v1_admin_config_test_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        }
      }
    },
    "/v1/admin/reload_env": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Reload Env",
        "operationId": "admin_reload_env_v1_admin_reload_env_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "example": {}
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminOkResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      }
    },
    "/v1/admin/errors": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Errors",
        "operationId": "admin_errors_v1_admin_errors_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "default": 50,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Admin Errors V1 Admin Errors Get"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/self_review": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Self Review",
        "operationId": "admin_self_review_v1_admin_self_review_get",
        "parameters": [
          {
            "name": "token",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Token"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Admin Self Review V1 Admin Self Review Get"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Self Review Post",
        "description": "Self-review endpoint - POST method returns 501 (not implemented).",
        "operationId": "admin_self_review_post_v1_admin_self_review_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Admin Self Review Post V1 Admin Self Review Post"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        }
      }
    },
    "/v1/admin/vector_store/bootstrap": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Vs Bootstrap",
        "operationId": "admin_vs_bootstrap_v1_admin_vector_store_bootstrap_post",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Name"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminBootstrapResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Forbidden"
          },
          "202": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminBootstrapResponse"
                }
              }
            },
            "description": "Accepted"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/vector_store/migrate": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Vs Migrate",
        "operationId": "admin_vs_migrate_v1_admin_vector_store_migrate_post",
        "parameters": [
          {
            "name": "action",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "pattern": "^(inventory|export|migrate)$",
              "default": "migrate",
              "title": "Action"
            }
          },
          {
            "name": "dry_run",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": true,
              "title": "Dry Run"
            }
          },
          {
            "name": "out_dir",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Out Dir"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminStartedResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/vector_store/bootstrap/stream": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Vs Bootstrap Stream",
        "description": "SSE stream for Qdrant bootstrap with idempotence.\n\nEmits events: start, step, done, error.",
        "operationId": "admin_vs_bootstrap_stream_v1_admin_vector_store_bootstrap_stream_get",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Name"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/vector_store/migrate/stream": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Vs Migrate Stream",
        "description": "SSE stream for Chroma \u2192 Qdrant migration with idempotence.\n\nUses in-process calls for portability; degrades gracefully when deps missing.",
        "operationId": "admin_vs_migrate_stream_v1_admin_vector_store_migrate_stream_get",
        "parameters": [
          {
            "name": "action",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "pattern": "^(inventory|export|migrate)$",
              "default": "migrate",
              "title": "Action"
            }
          },
          {
            "name": "dry_run",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": true,
              "title": "Dry Run"
            }
          },
          {
            "name": "out_dir",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Out Dir"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/vector_store/stats": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Vs Stats",
        "operationId": "admin_vs_stats_v1_admin_vector_store_stats_get",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Name"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/token_store/stats": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Token Store Stats",
        "description": "Get token store statistics including Redis availability and local storage usage.",
        "operationId": "admin_token_store_stats_v1_admin_token_store_stats_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        }
      }
    },
    "/v1/admin/qdrant/collections": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Qdrant Collections",
        "operationId": "admin_qdrant_collections_v1_admin_qdrant_collections_get",
        "parameters": [
          {
            "name": "names",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "CSV of collection names",
              "title": "Names"
            },
            "description": "CSV of collection names"
          },
          {
            "name": "token",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Token"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/admin/flags": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Flags",
        "description": "Flip runtime flags (process env) \u2014 best-effort.\n\nGuarded by admin token. Note: only affects this process; not persisted.",
        "operationId": "admin_flags_v1_admin_admin_flags_post",
        "parameters": [
          {
            "name": "token",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Token"
            }
          },
          {
            "name": "key",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Key"
            }
          },
          {
            "name": "value",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Value"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "anyOf": [
                  {
                    "$ref": "#/components/schemas/AdminFlagBody"
                  },
                  {
                    "type": "null"
                  }
                ],
                "title": "Body",
                "$ref": "#/components/schemas/AdminFlagBody"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminFlagsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/health/router_retrieval": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Health Router Retrieval",
        "description": "Snapshot of router + retrieval config with basic validation and telemetry hints.",
        "operationId": "admin_health_router_retrieval_v1_admin_health_router_retrieval_get",
        "parameters": [
          {
            "name": "token",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Token"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/flags": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin List Flags",
        "operationId": "admin_list_flags_v1_admin_flags_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        }
      }
    },
    "/v1/admin/admin/collections": {
      "get": {
        "tags": [
          "Admin",
          "Admin"
        ],
        "summary": "List Collections",
        "operationId": "list_collections_v1_admin_admin_collections_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        },
        "security": [
          {
            "OAuth2": [
              "admin:write"
            ]
          }
        ]
      }
    },
    "/v1/admin/admin/feature_flags": {
      "get": {
        "tags": [
          "Admin",
          "Admin"
        ],
        "summary": "Feature Flags",
        "operationId": "feature_flags_v1_admin_admin_feature_flags_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          }
        },
        "security": [
          {
            "OAuth2": [
              "admin:write"
            ]
          }
        ]
      }
    },
    "/v1/admin/retrieval/trace": {
      "get": {
        "tags": [
          "Admin",
          "Admin"
        ],
        "summary": "Retrieval Trace",
        "operationId": "retrieval_trace_v1_admin_retrieval_trace_get",
        "security": [
          {
            "OAuth2": [
              "admin:write"
            ]
          }
        ],
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Q"
            }
          },
          {
            "name": "k",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 50,
              "minimum": 1,
              "default": 5,
              "title": "K"
            }
          },
          {
            "name": "token",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Token"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/tv/config": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Tv Get Config",
        "description": "Mirror of /tv/config (GET) for docs under Admin tag.",
        "operationId": "admin_tv_get_config_v1_admin_tv_config_get",
        "parameters": [
          {
            "name": "resident_id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Resident Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TvConfigResponse"
                },
                "example": {
                  "status": "ok",
                  "config": {
                    "ambient_rotation": 45,
                    "rail": "safe",
                    "quiet_hours": {
                      "start": "22:00",
                      "end": "06:00"
                    },
                    "default_vibe": "Calm Night"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Tv Put Config",
        "description": "Mirror of /tv/config (PUT) for docs under Admin tag.",
        "operationId": "admin_tv_put_config_v1_admin_tv_config_put",
        "parameters": [
          {
            "name": "resident_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "default": "me",
              "title": "Resident Id"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TVConfigUpdate"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TvConfigResponse"
                },
                "example": {
                  "status": "ok",
                  "config": {
                    "ambient_rotation": 45,
                    "rail": "safe",
                    "quiet_hours": {
                      "start": "22:00",
                      "end": "06:00"
                    },
                    "default_vibe": "Calm Night"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/tv/photos": {
      "get": {
        "tags": [
          "TV"
        ],
        "summary": "Tv Photos",
        "description": "Return slideshow folder and items.\n\nConfigure via:\n  - TV_PHOTOS_DIR: absolute or relative path to image folder (default: data/shared_photos)\n  - TV_PHOTOS_URL_BASE: URL base the TV app uses to fetch files (default: /shared_photos)",
        "operationId": "tv_photos_v1_tv_photos_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/tv/photos/favorite": {
      "post": {
        "tags": [
          "TV"
        ],
        "summary": "Tv Photos Favorite",
        "operationId": "tv_photos_favorite_v1_tv_photos_favorite_post",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Name"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TvOkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/tv/weather": {
      "get": {
        "tags": [
          "TV"
        ],
        "summary": "Tv Weather",
        "description": "Return a minimal weather payload.\n\nIn production, wire to a weather provider; here we rely on environment overrides\nfor deterministic output during tests/dev.",
        "operationId": "tv_weather_v1_tv_weather_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/tv/alert": {
      "post": {
        "tags": [
          "TV"
        ],
        "summary": "Tv Alert",
        "description": "Escalation hook from TV to caregiver channel.\n\nThis is a thin wrapper; in V1.1 we can fan-out to SMS/voice/webhook.",
        "operationId": "tv_alert_v1_tv_alert_post",
        "parameters": [
          {
            "name": "kind",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "help",
              "title": "Kind"
            }
          },
          {
            "name": "note",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Note"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TvOkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/tv/tips": {
      "get": {
        "tags": [
          "TV"
        ],
        "summary": "Tv Ambient Tips",
        "description": "Ambient tips via lightweight local RAG-style mashup.\n\nExample: \"It's 72\u00b0F and cloudy; lo-fi playlist queued.\"",
        "operationId": "tv_ambient_tips_v1_tv_tips_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/tv/music/play": {
      "post": {
        "tags": [
          "TV"
        ],
        "summary": "Tv Music Play",
        "description": "Start playing a local preset playlist (placeholder).",
        "operationId": "tv_music_play_v1_tv_music_play_post",
        "parameters": [
          {
            "name": "preset",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Preset"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TvOkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/tv/prefs": {
      "get": {
        "tags": [
          "TV"
        ],
        "summary": "Tv Get Prefs",
        "operationId": "tv_get_prefs_v1_tv_prefs_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "TV"
        ],
        "summary": "Tv Set Prefs",
        "operationId": "tv_set_prefs_v1_tv_prefs_post",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Name"
            }
          },
          {
            "name": "speech_rate",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Speech Rate"
            }
          },
          {
            "name": "input_mode",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Input Mode"
            }
          },
          {
            "name": "font_scale",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Font Scale"
            }
          },
          {
            "name": "wake_word_enabled",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "boolean"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Wake Word Enabled"
            }
          },
          {
            "name": "address_style",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Address Style"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TvOkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "speech_rate": {
                    "type": "string"
                  },
                  "input_mode": {
                    "type": "string"
                  },
                  "font_scale": {
                    "type": "string"
                  },
                  "wake_word_enabled": {
                    "type": "boolean"
                  },
                  "address_style": {
                    "type": "string"
                  }
                },
                "example": {
                  "name": "Ava",
                  "speech_rate": "normal"
                }
              }
            }
          }
        }
      }
    },
    "/v1/tv/stage2": {
      "post": {
        "tags": [
          "TV"
        ],
        "summary": "Tv Stage2",
        "operationId": "tv_stage2_v1_tv_stage2_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Stage2Body"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TvOkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/tv/config": {
      "get": {
        "tags": [
          "TV"
        ],
        "summary": "Tv Get Config",
        "operationId": "tv_get_config_v1_tv_config_get",
        "parameters": [
          {
            "name": "resident_id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Resident Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TvConfigResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "TV"
        ],
        "summary": "Tv Put Config",
        "operationId": "tv_put_config_v1_tv_config_put",
        "parameters": [
          {
            "name": "resident_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "default": "me",
              "title": "Resident Id"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TVConfigUpdate"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TvConfigResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/ui/duck": {
      "post": {
        "tags": [
          "TV"
        ],
        "summary": "Ui Duck",
        "operationId": "ui_duck_v1_ui_duck_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DuckBody"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/ui/restore": {
      "post": {
        "tags": [
          "TV"
        ],
        "summary": "Ui Restore",
        "operationId": "ui_restore_v1_ui_restore_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OkResponse"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/config-check": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Config Check",
        "description": "Get a redacted configuration summary for operational visibility.\n\nReturns environment and feature flags without exposing sensitive values.\nUseful for debugging configuration issues and verifying deployments.",
        "operationId": "config_check_v1_admin_config_check_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/whoami": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Whoami Compat",
        "description": "Redirect legacy /whoami to canonical /v1/whoami with 308 and Deprecation header.",
        "operationId": "whoami_compat_whoami_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/spotify/status": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Spotify Status Compat",
        "description": "Call into Spotify integration status if available, else normalized 200.",
        "operationId": "spotify_status_compat_spotify_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/ask": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Ask Compat",
        "description": "Legacy root-level /ask endpoint.\n\nBehavior for tests and compat:\n- If the global router registry is unset -> 503 with code ROUTER_UNAVAILABLE\n- If the router raises -> 503 with code BACKEND_UNAVAILABLE\n- Otherwise, return the router's response (200)",
        "operationId": "ask_compat_ask_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/ask/replay/{rid}": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Ask Replay Compat",
        "description": "Legacy /ask/replay/{rid} endpoint - redirects to canonical /v1/ask/replay/{rid}.\n\nOnly enabled when LEGACY_CHAT=1 environment variable is set.",
        "operationId": "ask_replay_compat_ask_replay__rid__get",
        "deprecated": true,
        "parameters": [
          {
            "name": "rid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Rid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/status": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Status Compat",
        "description": "Redirect legacy /status to canonical /v1/status with 308 and Deprecation header.",
        "operationId": "status_compat_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/healthz": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Healthz Root",
        "description": "Simple health check endpoint for probes - root level for compatibility.",
        "operationId": "healthz_root_healthz_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/healthz": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Healthz V1",
        "description": "Versioned health endpoint for clients expecting /v1/healthz.",
        "operationId": "healthz_v1_v1_healthz_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/healthz/ready": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Health Ready",
        "description": "Core readiness with structured component status and caching.\n\nRequired checks (all must pass):\n- JWT secret present\n- DB/session store basic open\n- Vector store connectivity (read-only)\n\nEach component returns: healthy | degraded | unhealthy\nOverall status is unhealthy if any required component is unhealthy.\n\nAlways returns HTTP 200 - never 5xx. Degraded status is indicated in response body.\n\nCached for 250ms to prevent thundering herds.",
        "operationId": "health_ready_healthz_ready_get",
        "responses": {
          "200": {
            "description": "Readiness status (always 200, never 5xx)",
            "content": {
              "application/json": {
                "schema": {},
                "examples": {
                  "healthy": {
                    "summary": "All components healthy",
                    "value": {
                      "status": "ok",
                      "ok": true,
                      "components": {
                        "jwt_secret": {
                          "status": "healthy"
                        },
                        "db": {
                          "status": "healthy"
                        },
                        "vector_store": {
                          "status": "healthy"
                        }
                      }
                    }
                  },
                  "degraded": {
                    "summary": "Some components degraded",
                    "value": {
                      "status": "degraded",
                      "ok": true,
                      "components": {
                        "jwt_secret": {
                          "status": "healthy"
                        },
                        "db": {
                          "status": "healthy"
                        },
                        "vector_store": {
                          "status": "degraded"
                        }
                      }
                    }
                  },
                  "unhealthy": {
                    "summary": "Critical components unhealthy",
                    "value": {
                      "status": "unhealthy",
                      "ok": false,
                      "components": {
                        "jwt_secret": {
                          "status": "unhealthy"
                        },
                        "db": {
                          "status": "healthy"
                        },
                        "vector_store": {
                          "status": "healthy"
                        }
                      },
                      "failing": [
                        "jwt_secret"
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/v1/health": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Health Combined",
        "description": "Unified health snapshot that always returns HTTP 200.\n\nShape: { status: 'ok'|'degraded'|'fail', checks: { backend, jwt, database, vector_store, llama, ha, qdrant, spotify } }",
        "operationId": "health_combined_v1_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/health/vector_store": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Health Vector Store",
        "description": "Return a small diagnostic summary for the configured vector store.\n\nIntended for automated smoke tests: returns `ok` + store_type + config\nand a minimal write/read smoke check when possible.",
        "operationId": "health_vector_store_v1_health_vector_store_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Health Vector Store V1 Health Vector Store Get"
                }
              }
            }
          }
        }
      }
    },
    "/health/vector_store": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Health Vector Store",
        "description": "Return a small diagnostic summary for the configured vector store.\n\nIntended for automated smoke tests: returns `ok` + store_type + config\nand a minimal write/read smoke check when possible.",
        "operationId": "health_vector_store_health_vector_store_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Health Vector Store Health Vector Store Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/health/qdrant": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Health Qdrant",
        "description": "Check Qdrant health status.",
        "operationId": "health_qdrant_v1_health_qdrant_get",
        "responses": {
          "200": {
            "description": "Qdrant health status",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Health Qdrant V1 Health Qdrant Get"
                },
                "examples": {
                  "healthy": {
                    "summary": "Qdrant is healthy",
                    "value": {
                      "ok": true,
                      "status": "ok"
                    }
                  },
                  "unhealthy": {
                    "summary": "Qdrant is not responding",
                    "value": {
                      "ok": false,
                      "status": "error",
                      "error": "Connection timeout"
                    }
                  },
                  "skipped": {
                    "summary": "Qdrant not configured",
                    "value": {
                      "ok": false,
                      "status": "skipped"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/v1/health/chroma": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Health Chroma",
        "description": "Check Chroma health status.",
        "operationId": "health_chroma_v1_health_chroma_get",
        "responses": {
          "200": {
            "description": "Chroma health status",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Health Chroma V1 Health Chroma Get"
                },
                "examples": {
                  "healthy": {
                    "summary": "Chroma is healthy",
                    "value": {
                      "ok": true,
                      "status": "ok"
                    }
                  },
                  "unhealthy": {
                    "summary": "Chroma is not responding",
                    "value": {
                      "ok": false,
                      "status": "error",
                      "error": "Connection timeout"
                    }
                  },
                  "skipped": {
                    "summary": "Chroma not configured as vector store",
                    "value": {
                      "ok": false,
                      "status": "skipped"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/v1/health/google": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Health Google",
        "description": "Minimal Google health check used by the dashboard.",
        "operationId": "health_google_v1_health_google_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Health Google V1 Health Google Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/me": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Me",
        "operationId": "me_v1_me_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Me V1 Me Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/sessions": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Sessions",
        "operationId": "sessions_v1_sessions_get",
        "parameters": [
          {
            "name": "legacy",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Return legacy wrapped shape when 1 (deprecated; TODO remove by 2026-01-31)",
              "title": "Legacy"
            },
            "description": "Return legacy wrapped shape when 1 (deprecated; TODO remove by 2026-01-31)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "anyOf": [
                    {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "additionalProperties": true
                      }
                    },
                    {
                      "type": "object",
                      "additionalProperties": true
                    }
                  ],
                  "title": "Response Sessions V1 Sessions Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/sessions/paginated": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Sessions Paginated",
        "operationId": "sessions_paginated_v1_sessions_paginated_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "default": 50,
              "title": "Limit"
            }
          },
          {
            "name": "cursor",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Cursor"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Sessions Paginated V1 Sessions Paginated Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/sessions/{sid}/revoke": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Revoke Session",
        "operationId": "revoke_session_v1_sessions__sid__revoke_post",
        "parameters": [
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Sid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  },
                  "title": "Response Revoke Session V1 Sessions  Sid  Revoke Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/profile": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Get Profile",
        "operationId": "get_profile_v1_profile_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "security": [
          {
            "OAuth2": [
              "user:profile:read"
            ]
          }
        ]
      },
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Update Profile",
        "operationId": "update_profile_v1_profile_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserProfile"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProfileOk"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "OAuth2": [
              "user:profile:write"
            ]
          }
        ]
      }
    },
    "/v1/onboarding/status": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Get Onboarding Status",
        "operationId": "get_onboarding_status_v1_onboarding_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/onboarding/complete": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Complete Onboarding",
        "operationId": "complete_onboarding_v1_onboarding_complete_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "example": {
                    "status": "success"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/v1/config": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Config",
        "operationId": "config_v1_config_get",
        "security": [
          {
            "OAuth2": [
              "admin:write"
            ]
          }
        ],
        "parameters": [
          {
            "name": "token",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Token"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Config V1 Config Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/budget": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Budget Status",
        "operationId": "budget_status_v1_budget_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Budget Status V1 Budget Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "OAuth2": [
              "admin:write"
            ]
          }
        ]
      }
    },
    "/v1/status/budget": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Budget Status Alias",
        "operationId": "budget_status_alias_v1_status_budget_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Budget Status Alias V1 Status Budget Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "OAuth2": [
              "admin:write"
            ]
          }
        ]
      }
    },
    "/v1/ha_status": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Ha Status",
        "operationId": "ha_status_v1_ha_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Ha Status V1 Ha Status Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "OAuth2": [
              "admin:write"
            ]
          }
        ]
      }
    },
    "/v1/llama_status": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Llama Status",
        "description": "Report LLaMA health by attempting a minimal generation.",
        "operationId": "llama_status_v1_llama_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Llama Status V1 Llama Status Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "OAuth2": [
              "admin:write"
            ]
          }
        ]
      }
    },
    "/v1/status": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Full Status",
        "operationId": "full_status_v1_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Full Status V1 Status Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "OAuth2": [
              "admin:write"
            ]
          }
        ]
      }
    },
    "/v1/google/status": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Google Status Public",
        "description": "Lightweight Google status for /v1/google/status (no external calls).\n\nReturns minimal JSON so CI/tests can hit the route without auth or network.",
        "operationId": "google_status_public_v1_google_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Google Status Public V1 Google Status Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/rate_limit_status": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Rate Limit Status Public",
        "description": "Return current rate\u2011limit backend configuration and health (public).\n\nThis endpoint intentionally does not require authentication. It exposes\nnon-sensitive metadata about the active rate limiting backend so clients\nand tooling can adapt without needing credentials.",
        "operationId": "rate_limit_status_public_v1_rate_limit_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Rate Limit Status Public V1 Rate Limit Status Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/observability": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Observability Metrics",
        "description": "Observability metrics for /v1/ask requests.\n\nReturns golden queries for monitoring:\n- p95 latency by backend\n- error rate by backend and error type",
        "operationId": "observability_metrics_v1_observability_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Observability Metrics V1 Observability Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/status/integrations": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Integrations Status Fast",
        "description": "Fast integrations status for CI: returns OK without external calls.",
        "operationId": "integrations_status_fast_v1_status_integrations_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Integrations Status Fast V1 Status Integrations Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/status/rate_limit": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Rate Limit Fast",
        "description": "Fast rate limit status for CI: deterministic values, no external calls.",
        "operationId": "rate_limit_fast_v1_status_rate_limit_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Rate Limit Fast V1 Status Rate Limit Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/status/features": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Features",
        "operationId": "features_v1_status_features_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/status/vector_store": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Status Vector Store",
        "operationId": "status_vector_store_v1_status_vector_store_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Status Vector Store V1 Status Vector Store Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/admin/backup": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Admin Backup",
        "description": "Create an encrypted backup archive of data files.\n\nUses AES-256 encryption via `openssl enc` with a key provided by BACKUP_KEY.\nFiles included: data/*.json, stories/*.jsonl, sessions archive tarballs.\nOutput path controlled by BACKUP_DIR.",
        "operationId": "admin_backup_v1_admin_backup_post",
        "parameters": [
          {
            "name": "token",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Token"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BackupResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/models": {
      "get": {
        "tags": [
          "Care"
        ],
        "summary": "List Models",
        "operationId": "list_models_v1_models_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response List Models V1 Models Get"
                }
              }
            }
          }
        }
      }
    },
    "/csrf": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Get Csrf",
        "description": "Issuer endpoint for double-submit CSRF token.\n\nReturns JSON {\"csrf_token\": \"<token>\"} and sets a non-HttpOnly cookie\nvia the centralized cookie helper. Also stores token server-side for\nenhanced cross-site validation.",
        "operationId": "get_csrf_csrf_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/debug/oauth/routes": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Debug Oauth Routes",
        "description": "List relevant OAuth/Google routes currently registered.\n\nMakes route visibility obvious during troubleshooting.",
        "operationId": "debug_oauth_routes_v1_debug_oauth_routes_get",
        "parameters": [
          {
            "name": "request",
            "in": "query",
            "required": true,
            "schema": {
              "title": "Request"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/debug/oauth/config": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Debug Oauth Config",
        "description": "Show effective Google OAuth environment/config in one place.",
        "operationId": "debug_oauth_config_v1_debug_oauth_config_get",
        "parameters": [
          {
            "name": "request",
            "in": "query",
            "required": true,
            "schema": {
              "title": "Request"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/debug/cors-info": {
      "get": {
        "tags": [],
        "summary": "Cors Info",
        "operationId": "cors_info_debug_cors_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/spotify/debug": {
      "get": {
        "summary": "Spotify Debug",
        "description": "Debug endpoint to test authentication.",
        "operationId": "spotify_debug_v1_spotify_debug_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/spotify/debug/store": {
      "get": {
        "summary": "Debug Oauth Store",
        "description": "Debug endpoint to check OAuth store contents.",
        "operationId": "debug_oauth_store_v1_spotify_debug_store_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/spotify/test/store_tx": {
      "post": {
        "summary": "Test Store Tx",
        "description": "Test endpoint to store a transaction for testing.",
        "operationId": "test_store_tx_v1_spotify_test_store_tx_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/spotify/test/full_flow": {
      "post": {
        "summary": "Test Full Flow",
        "description": "Test endpoint that stores a transaction and returns the JWT state.",
        "operationId": "test_full_flow_v1_spotify_test_full_flow_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/spotify/connect": {
      "get": {
        "summary": "Spotify Connect",
        "description": "Initiate Spotify OAuth flow and return authorization URL.",
        "operationId": "spotify_connect_v1_spotify_connect_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/spotify/callback-test": {
      "get": {
        "summary": "Spotify Callback Test",
        "description": "Simple test callback.",
        "operationId": "spotify_callback_test_v1_spotify_callback_test_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/spotify/health": {
      "get": {
        "summary": "Spotify Health",
        "description": "Lightweight health check to confirm router mount and env wiring.\n\nReturns basic config flags without exposing secrets.",
        "operationId": "spotify_health_v1_spotify_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/spotify/debug-cookie": {
      "get": {
        "summary": "Spotify Debug Cookie",
        "description": "Dev-only helper (stubbed in production).",
        "operationId": "spotify_debug_cookie_v1_spotify_debug_cookie_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Spotify Debug Cookie V1 Spotify Debug Cookie Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/spotify/callback": {
      "post": {
        "summary": "Spotify Callback Post",
        "description": "POST shim for Spotify callback that redirects to GET canonical endpoint.",
        "operationId": "spotify_callback_post_v1_spotify_callback_post",
        "parameters": [
          {
            "name": "code",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Code"
            }
          },
          {
            "name": "state",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "State"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "Spotify Callback",
        "description": "Handle Spotify OAuth callback with stateless JWT state.\n\nRecovers user_id + PKCE code_verifier from JWT state + server store.\nNo cookies required - works even if browser sends zero cookies.",
        "operationId": "spotify_callback_v1_spotify_callback_get",
        "parameters": [
          {
            "name": "code",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Code"
            }
          },
          {
            "name": "state",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "State"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/spotify/disconnect": {
      "post": {
        "summary": "Spotify Disconnect Post",
        "description": "POST alias for disconnect endpoint (for tests).",
        "operationId": "spotify_disconnect_post_v1_spotify_disconnect_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Spotify Disconnect Post V1 Spotify Disconnect Post"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Spotify Disconnect",
        "description": "Disconnect Spotify by marking tokens as invalid.",
        "operationId": "spotify_disconnect_v1_spotify_disconnect_delete",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Spotify Disconnect V1 Spotify Disconnect Delete"
                }
              }
            }
          }
        }
      }
    },
    "/v1/spotify/refresh": {
      "post": {
        "summary": "Spotify Refresh",
        "description": "Explicit refresh endpoint so the frontend can silently recover access tokens.",
        "operationId": "spotify_refresh_v1_spotify_refresh_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SpotifyRefreshResponse"
                }
              }
            }
          }
        }
      }
    },
    "/v1/spotify/token-for-sdk": {
      "get": {
        "summary": "Spotify Token For Sdk",
        "description": "Get Spotify token for SDK - NEVER returns 401, returns 404 if no token.",
        "operationId": "spotify_token_for_sdk_v1_spotify_token_for_sdk_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/spotify/status": {
      "get": {
        "summary": "Spotify Status",
        "description": "Bulletproof Spotify integration status - NEVER returns 500 or 401.\n\nAlways returns structured reasons for frontend to make smart decisions.",
        "operationId": "spotify_status_v1_spotify_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SpotifyStatusResponse"
                }
              }
            }
          }
        }
      }
    },
    "/v1/integrations/spotify/status": {
      "get": {
        "summary": "Integrations Spotify Status",
        "description": "Get Spotify integration status for frontend polling.\n\nReturns status information that frontend can use to determine if reconnect is needed.",
        "operationId": "integrations_spotify_status_v1_integrations_spotify_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Integrations Spotify Status V1 Integrations Spotify Status Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/spotify/devices": {
      "get": {
        "tags": [
          "Music"
        ],
        "summary": "Devices",
        "operationId": "devices_v1_spotify_devices_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/spotify/play": {
      "post": {
        "tags": [
          "Music"
        ],
        "summary": "Play",
        "description": "Proxy play request to Spotify.\n\nBody shape: { \"uris\"?: [], \"context_uri\"?: \"\", \"device_id\"?: \"\" }",
        "operationId": "play_v1_spotify_play_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Body"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/status/preflight": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Preflight",
        "operationId": "preflight_v1_status_preflight_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Preflight V1 Status Preflight Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/google/test": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Test Endpoint",
        "operationId": "test_endpoint_v1_google_test_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/google/integration/connect": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Connect Endpoint",
        "description": "Compatibility endpoint for tests expecting /connect instead of /auth/google/login_url.",
        "operationId": "connect_endpoint_v1_google_integration_connect_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/google/integration/oauth/callback": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Legacy Oauth Callback",
        "description": "Compatibility shim: mint application cookies and redirect to root.\n\nTests expect a lightweight callback at `/google/oauth/callback` that behaves\nsimilarly to the canonical backend callback. For compatibility we mint\napplication JWTs and set auth cookies using the same helper as the newer\nintegration path.",
        "operationId": "legacy_oauth_callback_v1_google_integration_oauth_callback_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/google/gmail/send": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Gmail Send",
        "operationId": "gmail_send_v1_google_gmail_send_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SendEmailIn"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "example": {
                    "id": "m_123"
                  }
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/google/calendar/create": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Calendar Create",
        "operationId": "calendar_create_v1_google_calendar_create_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateEventIn"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "example": {
                    "id": "evt_123",
                    "htmlLink": "https://calendar.google.com/event?eid=..."
                  }
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/dev/login": {
      "post": {
        "summary": "Dev Login Route",
        "operationId": "dev_login_route_v1_auth_dev_login_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Body"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/dev/token": {
      "post": {
        "summary": "Dev Token Route",
        "operationId": "dev_token_route_v1_auth_dev_token_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "anyOf": [
                  {
                    "additionalProperties": true,
                    "type": "object"
                  },
                  {
                    "type": "null"
                  }
                ],
                "title": "Body"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/whoami": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_v1_whoami_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/list": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_v1_list_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/next": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_v1_next_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/today": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_v1_today_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/device_status": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_v1_device_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/music": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_v1_music_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/music/state": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_v1_music_state_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/music/devices": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_v1_music_devices_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/music/device": {
      "put": {
        "summary": "Handler",
        "operationId": "handler_v1_music_device_put",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/transcribe/{job_id}": {
      "post": {
        "summary": "Handler",
        "operationId": "handler_v1_transcribe__job_id__post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/admin/rate-limits/{key}": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_v1_admin_rate_limits__key__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/csrf": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_v1_csrf_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/v1/auth/finish": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_v1_auth_finish_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/debug/cookies": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_debug_cookies_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/ha/entities": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_ha_entities_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/ha/service": {
      "post": {
        "summary": "Handler",
        "operationId": "handler_ha_service_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/ha/resolve": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_ha_resolve_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/list": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_list_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/next": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_next_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/today": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_today_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/calendar/list": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_calendar_list_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/calendar/next": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_calendar_next_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/calendar/today": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_calendar_today_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/device_status": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_device_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/care/device_status": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_care_device_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/music": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_music_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/music/state": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_music_state_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/music/devices": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_music_devices_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/music/device": {
      "put": {
        "summary": "Handler",
        "operationId": "handler_music_device_put",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/transcribe/{job_id}": {
      "post": {
        "summary": "Handler",
        "operationId": "handler_transcribe__job_id__post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/tts/speak": {
      "post": {
        "summary": "Handler",
        "operationId": "handler_tts_speak_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/reload_env": {
      "post": {
        "summary": "Handler",
        "operationId": "handler_admin_reload_env_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/self_review": {
      "post": {
        "summary": "Handler",
        "operationId": "handler_admin_self_review_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/vector_store/bootstrap": {
      "post": {
        "summary": "Handler",
        "operationId": "handler_admin_vector_store_bootstrap_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/config": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_admin_config_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/errors": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_admin_errors_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/flags": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_admin_flags_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/metrics": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_admin_metrics_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/ping": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_admin_ping_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/rate-limits/{key}": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_admin_rate_limits__key__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/rbac/info": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_admin_rbac_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/router/decisions": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_admin_router_decisions_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/system/status": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_admin_system_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/admin/tokens/google": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_admin_tokens_google_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/integrations/google/status": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_integrations_google_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/integrations/spotify/status": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_integrations_spotify_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/ha_status": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_ha_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/llama_status": {
      "get": {
        "summary": "Handler",
        "operationId": "handler_llama_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/test-errors/test/validation-error": {
      "get": {
        "tags": [],
        "summary": "Test Validation Error",
        "description": "Test endpoint that raises a validation error using Pydantic model validation.\n\nPydantic's ValidationError construction changed across versions; instead of\nconstructing via internal helpers, exercise model validation to produce a\nValidationError instance which is then handled by the app's translator.",
        "operationId": "test_validation_error_test_errors_test_validation_error_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/value-error": {
      "get": {
        "tags": [],
        "summary": "Test Value Error",
        "description": "Test endpoint that raises a ValueError.",
        "operationId": "test_value_error_test_errors_test_value_error_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/key-error": {
      "get": {
        "tags": [],
        "summary": "Test Key Error",
        "description": "Test endpoint that raises a KeyError.",
        "operationId": "test_key_error_test_errors_test_key_error_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/type-error": {
      "get": {
        "tags": [],
        "summary": "Test Type Error",
        "description": "Test endpoint that raises a TypeError.",
        "operationId": "test_type_error_test_errors_test_type_error_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/permission-error": {
      "get": {
        "tags": [],
        "summary": "Test Permission Error",
        "description": "Test endpoint that raises a PermissionError.",
        "operationId": "test_permission_error_test_errors_test_permission_error_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/timeout-error": {
      "get": {
        "tags": [],
        "summary": "Test Timeout Error",
        "description": "Test endpoint that raises a TimeoutError.",
        "operationId": "test_timeout_error_test_errors_test_timeout_error_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/connection-error": {
      "get": {
        "tags": [],
        "summary": "Test Connection Error",
        "description": "Test endpoint that raises a ConnectionError.",
        "operationId": "test_connection_error_test_errors_test_connection_error_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/file-too-large": {
      "get": {
        "tags": [],
        "summary": "Test File Too Large",
        "description": "Test endpoint that simulates file too large error.",
        "operationId": "test_file_too_large_test_errors_test_file_too_large_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/internal-error": {
      "get": {
        "tags": [],
        "summary": "Test Internal Error",
        "description": "Test endpoint that raises a generic exception.",
        "operationId": "test_internal_error_test_errors_test_internal_error_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/raise-500": {
      "get": {
        "tags": [],
        "summary": "Raise 500",
        "description": "Compatibility endpoint expected by smoke tests to trigger a 500.\n\nRaise a StarletteHTTPException so it gets caught by the error handlers\nand properly formatted into the standard error envelope.",
        "operationId": "raise_500_test_errors_raise_500_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/raise-404": {
      "get": {
        "tags": [],
        "summary": "Raise 404",
        "description": "Compatibility endpoint expected by smoke tests to trigger a 404.\n\nRaise a StarletteHTTPException so it gets caught by the error handlers\nand properly formatted into the standard error envelope.",
        "operationId": "raise_404_test_errors_raise_404_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/unauthorized": {
      "get": {
        "tags": [],
        "summary": "Test Unauthorized",
        "description": "Test endpoint that raises unauthorized error.",
        "operationId": "test_unauthorized_test_errors_test_unauthorized_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/forbidden": {
      "get": {
        "tags": [],
        "summary": "Test Forbidden",
        "description": "Test endpoint that returns forbidden error.",
        "operationId": "test_forbidden_test_errors_test_forbidden_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/not-found": {
      "get": {
        "tags": [],
        "summary": "Test Not Found",
        "description": "Test endpoint that returns not found error.",
        "operationId": "test_not_found_test_errors_test_not_found_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/method-not-allowed": {
      "get": {
        "tags": [],
        "summary": "Test Method Not Allowed",
        "description": "Test endpoint that returns method not allowed error.",
        "operationId": "test_method_not_allowed_test_errors_test_method_not_allowed_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/payload-too-large": {
      "get": {
        "tags": [],
        "summary": "Test Payload Too Large",
        "description": "Test endpoint that returns payload too large error.",
        "operationId": "test_payload_too_large_test_errors_test_payload_too_large_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/validation-error-helper": {
      "get": {
        "tags": [],
        "summary": "Test Validation Error Helper",
        "description": "Test endpoint that uses validation_error helper.",
        "operationId": "test_validation_error_helper_test_errors_test_validation_error_helper_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/internal-error-helper": {
      "get": {
        "tags": [],
        "summary": "Test Internal Error Helper",
        "description": "Test endpoint that uses internal_error helper.",
        "operationId": "test_internal_error_helper_test_errors_test_internal_error_helper_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/test-errors/test/translate-common-exception": {
      "get": {
        "tags": [],
        "summary": "Test Translate Common Exception",
        "description": "Test endpoint that uses translate_common_exception function.",
        "operationId": "test_translate_common_exception_test_errors_test_translate_common_exception_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AckBody": {
        "properties": {
          "by": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "By"
          }
        },
        "type": "object",
        "title": "AckBody",
        "example": {
          "by": "caregiver_123"
        }
      },
      "AdminBootstrapResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status"
          },
          "collection": {
            "type": "string",
            "title": "Collection"
          },
          "existed": {
            "type": "string",
            "title": "Existed"
          }
        },
        "type": "object",
        "required": [
          "status",
          "collection",
          "existed"
        ],
        "title": "AdminBootstrapResponse",
        "example": {
          "collection": "kb:default",
          "existed": "False",
          "status": "ok"
        }
      },
      "AdminFlagBody": {
        "properties": {
          "key": {
            "type": "string",
            "title": "Key"
          },
          "value": {
            "type": "string",
            "title": "Value"
          }
        },
        "type": "object",
        "required": [
          "key",
          "value"
        ],
        "title": "AdminFlagBody",
        "example": {
          "key": "RETRIEVAL_PIPELINE",
          "value": "dual"
        }
      },
      "AdminFlagsResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "default": "ok"
          },
          "key": {
            "type": "string",
            "title": "Key"
          },
          "value": {
            "type": "string",
            "title": "Value"
          },
          "flags": {
            "additionalProperties": true,
            "type": "object",
            "title": "Flags"
          }
        },
        "type": "object",
        "required": [
          "key",
          "value",
          "flags"
        ],
        "title": "AdminFlagsResponse",
        "example": {
          "flags": {
            "RETRIEVAL_PIPELINE": "dual"
          },
          "key": "RETRIEVAL_PIPELINE",
          "status": "ok",
          "value": "dual"
        }
      },
      "AdminOkResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "default": "ok"
          }
        },
        "type": "object",
        "title": "AdminOkResponse",
        "example": {
          "status": "ok"
        }
      },
      "AdminStartedResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status"
          },
          "action": {
            "type": "string",
            "title": "Action"
          },
          "dry_run": {
            "type": "boolean",
            "title": "Dry Run"
          },
          "out_dir": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Out Dir"
          }
        },
        "type": "object",
        "required": [
          "status",
          "action",
          "dry_run"
        ],
        "title": "AdminStartedResponse",
        "example": {
          "action": "migrate",
          "dry_run": true,
          "out_dir": "/tmp/out",
          "status": "started"
        }
      },
      "AdminStatusResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "default": "ok"
          },
          "area": {
            "type": "string",
            "title": "Area",
            "default": "admin"
          },
          "rbac_version": {
            "type": "string",
            "title": "Rbac Version",
            "default": "2.0"
          },
          "authenticated": {
            "type": "boolean",
            "title": "Authenticated"
          },
          "user_scopes": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "User Scopes"
          },
          "user_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "User Id"
          }
        },
        "type": "object",
        "required": [
          "authenticated",
          "user_scopes"
        ],
        "title": "AdminStatusResponse",
        "example": {
          "area": "admin",
          "authenticated": true,
          "rbac_version": "2.0",
          "status": "ok",
          "user_id": "user123",
          "user_scopes": [
            "admin",
            "admin:write",
            "admin:read"
          ]
        }
      },
      "AlertCreate": {
        "properties": {
          "resident_id": {
            "type": "string",
            "title": "Resident Id"
          },
          "kind": {
            "type": "string",
            "title": "Kind"
          },
          "severity": {
            "type": "string",
            "title": "Severity",
            "default": "info"
          },
          "note": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Note"
          }
        },
        "type": "object",
        "required": [
          "resident_id",
          "kind"
        ],
        "title": "AlertCreate",
        "example": {
          "kind": "help",
          "note": "Grandma pressed the help button",
          "resident_id": "r1",
          "severity": "critical"
        }
      },
      "AlertRecord": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id"
          },
          "resident_id": {
            "type": "string",
            "title": "Resident Id"
          },
          "kind": {
            "type": "string",
            "title": "Kind"
          },
          "severity": {
            "type": "string",
            "title": "Severity"
          },
          "note": {
            "type": "string",
            "title": "Note"
          },
          "created_at": {
            "type": "number",
            "title": "Created At"
          },
          "status": {
            "type": "string",
            "title": "Status"
          },
          "ack_at": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Ack At"
          },
          "resolved_at": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Resolved At"
          }
        },
        "type": "object",
        "required": [
          "id",
          "resident_id",
          "kind",
          "severity",
          "note",
          "created_at",
          "status"
        ],
        "title": "AlertRecord",
        "example": {
          "created_at": 1736467200.0,
          "id": "a01",
          "kind": "help",
          "note": "Grandma pressed the help button",
          "resident_id": "r1",
          "severity": "critical",
          "status": "open"
        }
      },
      "AskRequest": {
        "properties": {
          "prompt": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "items": {
                  "$ref": "#/components/schemas/Message"
                },
                "type": "array"
              }
            ],
            "title": "Prompt",
            "description": "Canonical prompt: text string or messages array",
            "examples": [
              "What is the capital of France?",
              [
                {
                  "content": "Hello, how are you?",
                  "role": "user"
                }
              ]
            ]
          },
          "model": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Model",
            "description": "Preferred model id (e.g., gpt-4o, llama3)",
            "examples": [
              "gpt-4o",
              "llama3"
            ]
          },
          "model_override": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Model Override",
            "description": "Legacy alias for model (normalized to model field)"
          },
          "stream": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Stream",
            "description": "Force SSE when true; otherwise negotiated via Accept",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "prompt"
        ],
        "title": "AskRequest",
        "description": "Request model for chat API endpoints.",
        "examples": [
          {
            "description": "Basic text input for simple queries",
            "summary": "Simple text prompt",
            "value": {
              "model": "gpt-4o",
              "prompt": "What is the capital of France?",
              "stream": false
            }
          },
          {
            "description": "Structured chat format preserving role information",
            "summary": "Chat format with messages",
            "value": {
              "model": "llama3",
              "prompt": [
                {
                  "content": "You are a helpful geography tutor.",
                  "role": "system"
                },
                {
                  "content": "What is the capital of France?",
                  "role": "user"
                },
                {
                  "content": "The capital of France is Paris.",
                  "role": "assistant"
                },
                {
                  "content": "What about Italy?",
                  "role": "user"
                }
              ],
              "stream": true
            }
          },
          {
            "description": "Backward compatibility with model_override field",
            "summary": "Legacy model_override usage",
            "value": {
              "model_override": "llama3",
              "prompt": "Translate to French",
              "stream": false
            }
          }
        ]
      },
      "BackupResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "default": "ok"
          },
          "path": {
            "type": "string",
            "title": "Path"
          }
        },
        "type": "object",
        "required": [
          "path"
        ],
        "title": "BackupResponse",
        "example": {
          "path": "/app/backups/backup.tar.gz.enc",
          "status": "ok"
        }
      },
      "Body_dev_token_v1_auth_token_post": {
        "properties": {
          "username": {
            "type": "string",
            "title": "Username"
          },
          "password": {
            "type": "string",
            "title": "Password"
          },
          "scope": {
            "type": "string",
            "title": "Scope",
            "default": ""
          }
        },
        "type": "object",
        "title": "Body_dev_token_v1_auth_token_post"
      },
      "CreateEventIn": {
        "properties": {
          "title": {
            "type": "string",
            "title": "Title"
          },
          "start_iso": {
            "type": "string",
            "title": "Start Iso"
          },
          "end_iso": {
            "type": "string",
            "title": "End Iso"
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description"
          },
          "attendees": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Attendees"
          },
          "calendar_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Calendar Id",
            "default": "primary"
          },
          "location": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Location"
          }
        },
        "type": "object",
        "required": [
          "title",
          "start_iso",
          "end_iso"
        ],
        "title": "CreateEventIn",
        "example": {
          "end_iso": "2025-08-11T10:30:00-04:00",
          "start_iso": "2025-08-11T10:00:00-04:00",
          "title": "Dentist"
        }
      },
      "DuckBody": {
        "properties": {
          "level": {
            "type": "integer",
            "title": "Level",
            "default": 15
          }
        },
        "type": "object",
        "title": "DuckBody",
        "example": {
          "level": 15
        }
      },
      "Event": {
        "properties": {
          "date": {
            "type": "string",
            "title": "Date"
          },
          "time": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Time"
          },
          "title": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Title"
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description"
          },
          "location": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Location"
          }
        },
        "type": "object",
        "required": [
          "date"
        ],
        "title": "Event",
        "example": {
          "date": "2025-08-12",
          "description": "Annual checkup",
          "location": "Clinic",
          "time": "09:30",
          "title": "Doctor appointment"
        }
      },
      "EventsResponse": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/Event"
            },
            "type": "array",
            "title": "Items"
          }
        },
        "type": "object",
        "required": [
          "items"
        ],
        "title": "EventsResponse",
        "example": {
          "items": [
            {
              "date": "2025-08-12",
              "description": "Annual checkup",
              "location": "Clinic",
              "time": "09:30",
              "title": "Doctor appointment"
            }
          ]
        }
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "Heartbeat": {
        "properties": {
          "device_id": {
            "type": "string",
            "title": "Device Id"
          },
          "resident_id": {
            "type": "string",
            "title": "Resident Id"
          },
          "battery_pct": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Battery Pct"
          }
        },
        "type": "object",
        "required": [
          "device_id",
          "resident_id"
        ],
        "title": "Heartbeat",
        "example": {
          "battery_pct": 92,
          "device_id": "dev-abc",
          "resident_id": "r1"
        }
      },
      "LoginOut": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status"
          },
          "user_id": {
            "type": "string",
            "title": "User Id"
          },
          "access_token": {
            "type": "string",
            "title": "Access Token"
          },
          "refresh_token": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Refresh Token"
          },
          "session_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Session Id"
          },
          "csrf_token": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Csrf Token"
          }
        },
        "type": "object",
        "required": [
          "status",
          "user_id",
          "access_token"
        ],
        "title": "LoginOut"
      },
      "Message": {
        "properties": {
          "role": {
            "type": "string",
            "title": "Role",
            "description": "Message role: system|user|assistant"
          },
          "content": {
            "type": "string",
            "maxLength": 8000,
            "minLength": 1,
            "title": "Content",
            "description": "Message text content"
          }
        },
        "type": "object",
        "required": [
          "role",
          "content"
        ],
        "title": "Message",
        "description": "Chat message with role and content."
      },
      "OkResponse": {
        "properties": {
          "ok": {
            "type": "boolean",
            "title": "Ok",
            "default": true
          },
          "status": {
            "type": "string",
            "title": "Status",
            "default": "ok"
          }
        },
        "type": "object",
        "title": "OkResponse",
        "example": {
          "ok": true,
          "status": "ok"
        }
      },
      "ProfileOk": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "default": "success"
          }
        },
        "type": "object",
        "title": "ProfileOk",
        "example": {
          "status": "success"
        }
      },
      "QuietHours": {
        "properties": {
          "start": {
            "anyOf": [
              {
                "type": "string",
                "pattern": "^\\d{2}:\\d{2}$"
              },
              {
                "type": "null"
              }
            ],
            "title": "Start"
          },
          "end": {
            "anyOf": [
              {
                "type": "string",
                "pattern": "^\\d{2}:\\d{2}$"
              },
              {
                "type": "null"
              }
            ],
            "title": "End"
          }
        },
        "type": "object",
        "title": "QuietHours",
        "example": {
          "end": "06:00",
          "start": "22:00"
        }
      },
      "RbacInfoResponse": {
        "properties": {
          "scopes_available": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object",
            "title": "Scopes Available"
          },
          "roles_available": {
            "additionalProperties": {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            "type": "object",
            "title": "Roles Available"
          },
          "user_scopes": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "User Scopes"
          },
          "effective_permissions": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Effective Permissions"
          }
        },
        "type": "object",
        "required": [
          "scopes_available",
          "roles_available",
          "user_scopes",
          "effective_permissions"
        ],
        "title": "RbacInfoResponse",
        "example": {
          "effective_permissions": [
            "system_management",
            "user_management",
            "metrics_access"
          ],
          "roles_available": {
            "admin": [
              "admin",
              "admin:write",
              "admin:read"
            ],
            "caregiver": [
              "care:caregiver",
              "user:profile"
            ]
          },
          "scopes_available": {
            "admin": "Full administrative access",
            "admin:read": "Administrative read operations",
            "admin:write": "Administrative write operations"
          },
          "user_scopes": [
            "admin",
            "admin:write"
          ]
        }
      },
      "RefreshOut": {
        "properties": {
          "rotated": {
            "type": "boolean",
            "title": "Rotated"
          },
          "access_token": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Access Token"
          },
          "user_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "User Id"
          },
          "csrf_token": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Csrf Token"
          },
          "csrf": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Csrf"
          }
        },
        "type": "object",
        "required": [
          "rotated"
        ],
        "title": "RefreshOut"
      },
      "RegisterOut": {
        "properties": {
          "access_token": {
            "type": "string",
            "title": "Access Token"
          },
          "refresh_token": {
            "type": "string",
            "title": "Refresh Token"
          }
        },
        "type": "object",
        "required": [
          "access_token",
          "refresh_token"
        ],
        "title": "RegisterOut"
      },
      "ReminderCreate": {
        "properties": {
          "text": {
            "type": "string",
            "title": "Text"
          },
          "when": {
            "type": "string",
            "title": "When"
          },
          "channel": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Channel"
          }
        },
        "type": "object",
        "required": [
          "text",
          "when"
        ],
        "title": "ReminderCreate",
        "example": {
          "channel": "sms",
          "text": "Take meds",
          "when": "2025-01-01T09:00:00Z"
        }
      },
      "RevokeReq": {
        "properties": {
          "sid": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Sid"
          },
          "user_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "User Id"
          },
          "jti": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Jti"
          }
        },
        "type": "object",
        "title": "RevokeReq",
        "description": "Request model for revoke endpoint."
      },
      "SendEmailIn": {
        "properties": {
          "to": {
            "type": "string",
            "title": "To"
          },
          "subject": {
            "type": "string",
            "title": "Subject"
          },
          "body_text": {
            "type": "string",
            "title": "Body Text"
          },
          "from_alias": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "From Alias"
          }
        },
        "type": "object",
        "required": [
          "to",
          "subject",
          "body_text"
        ],
        "title": "SendEmailIn",
        "example": {
          "body_text": "Hello",
          "subject": "Hi",
          "to": "a@b.com"
        }
      },
      "ServiceAck": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "default": "ok"
          }
        },
        "type": "object",
        "title": "ServiceAck",
        "example": {
          "status": "ok"
        }
      },
      "ServiceRequest": {
        "properties": {
          "domain": {
            "type": "string",
            "title": "Domain"
          },
          "service": {
            "type": "string",
            "title": "Service"
          },
          "data": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Data"
          }
        },
        "type": "object",
        "required": [
          "domain",
          "service"
        ],
        "title": "ServiceRequest",
        "example": {
          "data": {
            "entity_id": "light.kitchen"
          },
          "domain": "light",
          "service": "turn_on"
        }
      },
      "SessionBody": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id"
          },
          "resident_id": {
            "type": "string",
            "title": "Resident Id"
          },
          "title": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Title"
          },
          "transcript_uri": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Transcript Uri"
          }
        },
        "type": "object",
        "required": [
          "id",
          "resident_id"
        ],
        "title": "SessionBody",
        "example": {
          "id": "s_01HABCDEF",
          "resident_id": "r1",
          "title": "Morning check-in",
          "transcript_uri": "s3://bucket/transcripts/s_01HABCDEF.txt"
        }
      },
      "SpotifyRefreshResponse": {
        "properties": {
          "refreshed": {
            "type": "boolean",
            "title": "Refreshed"
          },
          "reason": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/SpotifyStatusReason"
              },
              {
                "type": "null"
              }
            ]
          },
          "details": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Details"
          }
        },
        "type": "object",
        "required": [
          "refreshed"
        ],
        "title": "SpotifyRefreshResponse"
      },
      "SpotifyStatusReason": {
        "type": "string",
        "enum": [
          "ok",
          "not_authenticated",
          "auth_resolution_error",
          "no_tokens",
          "expired_access_token",
          "invalid_refresh_token",
          "revoked",
          "spotify_api_down",
          "devices_none",
          "unknown_error"
        ],
        "title": "SpotifyStatusReason"
      },
      "SpotifyStatusResponse": {
        "properties": {
          "connected": {
            "type": "boolean",
            "title": "Connected"
          },
          "devices_ok": {
            "type": "boolean",
            "title": "Devices Ok"
          },
          "state_ok": {
            "type": "boolean",
            "title": "State Ok"
          },
          "reason": {
            "$ref": "#/components/schemas/SpotifyStatusReason"
          },
          "details": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Details"
          },
          "expires_at": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Expires At"
          },
          "last_refresh_at": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Refresh At"
          },
          "refreshed": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Refreshed"
          },
          "scopes": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Scopes"
          }
        },
        "type": "object",
        "required": [
          "connected",
          "devices_ok",
          "state_ok",
          "reason"
        ],
        "title": "SpotifyStatusResponse"
      },
      "Stage2Body": {
        "properties": {
          "tiles": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tiles"
          },
          "rhythm": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rhythm"
          },
          "helpfulness": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Helpfulness"
          }
        },
        "type": "object",
        "title": "Stage2Body",
        "example": {
          "helpfulness": "high",
          "rhythm": "morning",
          "tiles": [
            "calendar",
            "music"
          ]
        }
      },
      "TTSAck": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "default": "ok"
          },
          "message": {
            "type": "string",
            "title": "Message",
            "default": "TTS request accepted"
          }
        },
        "type": "object",
        "title": "TTSAck",
        "example": {
          "message": "TTS request accepted",
          "status": "ok"
        }
      },
      "TTSRequest": {
        "properties": {
          "text": {
            "type": "string",
            "title": "Text"
          },
          "mode": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Mode",
            "default": "utility"
          },
          "intent": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Intent"
          },
          "sensitive": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Sensitive"
          },
          "voice": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Voice"
          }
        },
        "type": "object",
        "required": [
          "text"
        ],
        "title": "TTSRequest",
        "example": {
          "intent": "notify",
          "mode": "utility",
          "sensitive": false,
          "text": "Hello there!",
          "voice": "alloy"
        }
      },
      "TVConfigUpdate": {
        "properties": {
          "ambient_rotation": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Ambient Rotation"
          },
          "rail": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rail"
          },
          "quiet_hours": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/QuietHours"
              },
              {
                "type": "null"
              }
            ]
          },
          "default_vibe": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Default Vibe"
          }
        },
        "type": "object",
        "title": "TVConfigUpdate",
        "example": {
          "ambient_rotation": 15,
          "default_vibe": "Calm Night",
          "rail": "admin"
        }
      },
      "TokenExamplesOut": {
        "properties": {
          "samples": {
            "additionalProperties": true,
            "type": "object",
            "title": "Samples"
          },
          "scopes": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Scopes"
          },
          "notes": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Notes"
          }
        },
        "type": "object",
        "required": [
          "samples",
          "scopes",
          "notes"
        ],
        "title": "TokenExamplesOut"
      },
      "TokenOut": {
        "properties": {
          "access_token": {
            "type": "string",
            "title": "Access Token"
          },
          "token_type": {
            "type": "string",
            "title": "Token Type"
          }
        },
        "type": "object",
        "required": [
          "access_token",
          "token_type"
        ],
        "title": "TokenOut"
      },
      "TvConfig": {
        "properties": {
          "ambient_rotation": {
            "type": "integer",
            "title": "Ambient Rotation",
            "default": 30
          },
          "rail": {
            "type": "string",
            "enum": [
              "safe",
              "admin",
              "open"
            ],
            "title": "Rail",
            "default": "safe"
          },
          "quiet_hours": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/QuietHours"
              },
              {
                "type": "null"
              }
            ]
          },
          "default_vibe": {
            "type": "string",
            "title": "Default Vibe",
            "default": "Calm Night"
          }
        },
        "type": "object",
        "title": "TvConfig",
        "example": {
          "ambient_rotation": 45,
          "default_vibe": "Calm Night",
          "quiet_hours": {
            "end": "06:00",
            "start": "22:00"
          },
          "rail": "safe"
        }
      },
      "TvConfigResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "default": "ok"
          },
          "config": {
            "$ref": "#/components/schemas/TvConfig"
          }
        },
        "type": "object",
        "required": [
          "config"
        ],
        "title": "TvConfigResponse",
        "example": {
          "config": {
            "ambient_rotation": 45,
            "default_vibe": "Calm Night",
            "quiet_hours": {
              "end": "06:00",
              "start": "22:00"
            },
            "rail": "safe"
          },
          "status": "ok"
        }
      },
      "TvOkResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "default": "ok"
          }
        },
        "type": "object",
        "title": "TvOkResponse",
        "example": {
          "status": "ok"
        }
      },
      "UserProfile": {
        "properties": {
          "name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Name"
          },
          "email": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email"
          },
          "timezone": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Timezone"
          },
          "language": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Language"
          },
          "communication_style": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Communication Style"
          },
          "interests": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Interests"
          },
          "occupation": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Occupation"
          },
          "home_location": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Home Location"
          },
          "preferred_model": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Preferred Model"
          },
          "notification_preferences": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Notification Preferences"
          },
          "calendar_integration": {
            "type": "boolean",
            "title": "Calendar Integration",
            "default": false
          },
          "gmail_integration": {
            "type": "boolean",
            "title": "Gmail Integration",
            "default": false
          },
          "onboarding_completed": {
            "type": "boolean",
            "title": "Onboarding Completed",
            "default": false
          }
        },
        "type": "object",
        "title": "UserProfile",
        "example": {
          "calendar_integration": true,
          "email": "ava@example.com",
          "gmail_integration": false,
          "language": "en",
          "name": "Ava",
          "notification_preferences": {
            "sms": true
          },
          "preferred_model": "gpt-4o-mini",
          "timezone": "America/Los_Angeles"
        }
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      },
      "WSSubscribeExample": {
        "properties": {
          "action": {
            "type": "string",
            "title": "Action",
            "default": "subscribe"
          },
          "topic": {
            "type": "string",
            "title": "Topic",
            "default": "resident:r1"
          }
        },
        "type": "object",
        "title": "WSSubscribeExample",
        "example": {
          "action": "subscribe",
          "topic": "resident:r1"
        }
      },
      "WSTopicsInfo": {
        "properties": {
          "subscribe_example": {
            "$ref": "#/components/schemas/WSSubscribeExample",
            "default": {
              "action": "subscribe",
              "topic": "resident:r1"
            }
          },
          "topics": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Topics",
            "default": [
              "resident:{resident_id}"
            ]
          },
          "events_example": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Events Example",
            "default": [
              "device.heartbeat",
              "alert.created",
              "alert.acknowledged",
              "alert.resolved",
              "tv.config.updated"
            ]
          }
        },
        "type": "object",
        "title": "WSTopicsInfo",
        "example": {
          "events_example": [
            "device.heartbeat",
            "alert.created",
            "alert.acknowledged",
            "alert.resolved",
            "tv.config.updated"
          ],
          "subscribe_example": {
            "action": "subscribe",
            "topic": "resident:r1"
          },
          "topics": [
            "resident:{resident_id}"
          ]
        }
      },
      "WebhookAck": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "default": "ok"
          }
        },
        "type": "object",
        "title": "WebhookAck"
      }
    },
    "securitySchemes": {
      "OAuth2": {
        "type": "oauth2",
        "flows": {
          "password": {
            "scopes": {
              "care:resident": "Resident-level care features (presence, sessions, HA actions)",
              "care:caregiver": "Caregiver portal and actions",
              "music:control": "Control music playback and devices",
              "admin:write": "Administrative endpoints: flags, metrics, backups",
              "chat:write": "Send messages to AI chat endpoints"
            },
            "tokenUrl": "/v1/auth/token"
          }
        }
      },
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  },
  "security": [],
  "servers": [
    {
      "url": "http://localhost:8000"
    }
  ]
}