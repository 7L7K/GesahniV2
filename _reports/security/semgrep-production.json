{"version":"1.136.0","results":[{"check_id":"python.flask.security.audit.directly-returned-format-string.directly-returned-format-string","path":"app/integrations/google/routes.py","start":{"line":91,"col":13,"offset":2783},"end":{"line":91,"col":39,"offset":2809},"extra":{"message":"Detected Flask route directly returning a formatted string. This is subject to cross-site scripting if user input can reach the string. Consider using the template engine instead and rendering pages with 'render_template()'.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","technology":["flask"],"references":["https://owasp.org/Top10/A03_2021-Injection"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/python.flask.security.audit.directly-returned-format-string.directly-returned-format-string","shortlink":"https://sg.run/Zv6o"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.flask.security.audit.directly-returned-format-string.directly-returned-format-string","path":"app/security.py","start":{"line":825,"col":5,"offset":29408},"end":{"line":825,"col":22,"offset":29425},"extra":{"message":"Detected Flask route directly returning a formatted string. This is subject to cross-site scripting if user input can reach the string. Consider using the template engine instead and rendering pages with 'render_template()'.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","technology":["flask"],"references":["https://owasp.org/Top10/A03_2021-Injection"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/python.flask.security.audit.directly-returned-format-string.directly-returned-format-string","shortlink":"https://sg.run/Zv6o"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.flask.security.audit.directly-returned-format-string.directly-returned-format-string","path":"app/security.py","start":{"line":1895,"col":9,"offset":69824},"end":{"line":1895,"col":31,"offset":69846},"extra":{"message":"Detected Flask route directly returning a formatted string. This is subject to cross-site scripting if user input can reach the string. Consider using the template engine instead and rendering pages with 'render_template()'.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","technology":["flask"],"references":["https://owasp.org/Top10/A03_2021-Injection"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/python.flask.security.audit.directly-returned-format-string.directly-returned-format-string","shortlink":"https://sg.run/Zv6o"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.flask.security.audit.directly-returned-format-string.directly-returned-format-string","path":"app/url_helpers.py","start":{"line":144,"col":13,"offset":3890},"end":{"line":144,"col":39,"offset":3916},"extra":{"message":"Detected Flask route directly returning a formatted string. This is subject to cross-site scripting if user input can reach the string. Consider using the template engine instead and rendering pages with 'render_template()'.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","technology":["flask"],"references":["https://owasp.org/Top10/A03_2021-Injection"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/python.flask.security.audit.directly-returned-format-string.directly-returned-format-string","shortlink":"https://sg.run/Zv6o"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line monitoring/prometheus/recording_rules.yml:25:\n (approximate error location; error nearby after) error calling parser: could not find expected ':' character 0 position 0 returned: 0","path":"monitoring/prometheus/recording_rules.yml"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line prometheus-google-alerts.yml:30:\n (approximate error location; error nearby after) error calling parser: found character that cannot start any token character 0 position 0 returned: 0","path":"prometheus-google-alerts.yml"},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"frontend/src/app/settings/Integrations/GoogleCard.tsx","start":{"line":273,"col":90,"offset":0},"end":{"line":273,"col":133,"offset":43}}]],"message":"Syntax error at line frontend/src/app/settings/Integrations/GoogleCard.tsx:273:\n `& Calendar for smart alerts and scheduling.` was unexpected","path":"frontend/src/app/settings/Integrations/GoogleCard.tsx","spans":[{"file":"frontend/src/app/settings/Integrations/GoogleCard.tsx","start":{"line":273,"col":90,"offset":0},"end":{"line":273,"col":133,"offset":43}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"frontend/src/app/settings/SettingsPageInner.tsx","start":{"line":549,"col":54,"offset":0},"end":{"line":549,"col":61,"offset":7}},{"path":"frontend/src/app/settings/SettingsPageInner.tsx","start":{"line":828,"col":96,"offset":0},"end":{"line":828,"col":104,"offset":8}},{"path":"frontend/src/app/settings/SettingsPageInner.tsx","start":{"line":901,"col":95,"offset":0},"end":{"line":901,"col":102,"offset":7}},{"path":"frontend/src/app/settings/SettingsPageInner.tsx","start":{"line":1277,"col":94,"offset":0},"end":{"line":1277,"col":102,"offset":8}},{"path":"frontend/src/app/settings/SettingsPageInner.tsx","start":{"line":1316,"col":91,"offset":0},"end":{"line":1316,"col":100,"offset":9}}]],"message":"Syntax error at line frontend/src/app/settings/SettingsPageInner.tsx:549:\n `& Retry` was unexpected","path":"frontend/src/app/settings/SettingsPageInner.tsx","spans":[{"file":"frontend/src/app/settings/SettingsPageInner.tsx","start":{"line":549,"col":54,"offset":0},"end":{"line":549,"col":61,"offset":7}},{"file":"frontend/src/app/settings/SettingsPageInner.tsx","start":{"line":828,"col":96,"offset":0},"end":{"line":828,"col":104,"offset":8}},{"file":"frontend/src/app/settings/SettingsPageInner.tsx","start":{"line":901,"col":95,"offset":0},"end":{"line":901,"col":102,"offset":7}},{"file":"frontend/src/app/settings/SettingsPageInner.tsx","start":{"line":1277,"col":94,"offset":0},"end":{"line":1277,"col":102,"offset":8}},{"file":"frontend/src/app/settings/SettingsPageInner.tsx","start":{"line":1316,"col":91,"offset":0},"end":{"line":1316,"col":100,"offset":9}}]}],"paths":{"scanned":[".coveragerc",".env.example",".github/workflows/auth-csrf-audit.yml",".github/workflows/auth-redirect-canary.yml",".github/workflows/auth-redirect-hardening.yml",".github/workflows/contract-check.yml",".github/workflows/db-health-check.yml",".github/workflows/generate-sdks.yml",".github/workflows/performance.yml",".github/workflows/route-coverage.yml",".github/workflows/security-zap-semgrep.yml",".github/workflows/tests.yml",".github/workflows/update-contracts.yml",".gitignore",".hypothesis/examples/04e6b3400353b141/0c394a3d3239cecb",".hypothesis/examples/04e6b3400353b141/b1144fbe440e9f83",".hypothesis/examples/04e6b3400353b141/c659fbe510d53028",".hypothesis/examples/04e6b3400353b141/dbf77d239d8cbcdc",".hypothesis/examples/04e6b3400353b141/e82864e4df893696",".hypothesis/examples/0c394a3d3239cecb/c9dd75cdb609942e",".hypothesis/examples/b1144fbe440e9f83/a4cc3d187deb5274",".hypothesis/examples/c659fbe510d53028/cdf84bb626c9f96d",".hypothesis/examples/dbf77d239d8cbcdc/7b115fbdca4f1371",".hypothesis/examples/e82864e4df893696/ea8f7953a876d3c1",".hypothesis/unicode_data/15.0.0/charmap.json.gz",".modelrc",".pre-commit-config.yaml",".python-version",".secrets.baseline",".semgrepignore",".uvicorn_pid","000","Makefile","__PATCHFILE_PLACEHOLDER__","__PATCHFILE__","__apply_tests_patch_2__","__apply_tests_patch__","alembic.ini","analyze_mutating_endpoints.py","analyze_route_patterns.py","analyze_routes.py","analyze_routes_protection.py","analyze_routes_refined.py","app/__init__.py","app/adapters/__init__.py","app/adapters/memory/__init__.py","app/adapters/memory/_types.py","app/adapters/memory/legacy.py","app/adapters/rag/__init__.py","app/adapters/rag/ragflow_adapter.py","app/adapters/voice/__init__.py","app/adapters/voice/openai_tts.py","app/adapters/voice/openvoice_adapter.py","app/adapters/voice/pipecat_adapter.py","app/adapters/voice/piper_tts.py","app/admin/routes/__init__.py","app/admin_ui_assets/index.html","app/alias_store.py","app/analytics.py","app/api/__init__.py","app/api/_deps.py","app/api/_utils.py","app/api/admin.py","app/api/admin_ui.py","app/api/ask.py","app/api/auth.py","app/api/auth_password.py","app/api/auth_router_dev.py","app/api/auth_router_pats.py","app/api/auth_router_refresh.py","app/api/calendar.py","app/api/capture.py","app/api/care.py","app/api/care_ws.py","app/api/caregiver_auth.py","app/api/config_check.py","app/api/contacts.py","app/api/core_misc.py","app/api/debug.py","app/api/dev.py","app/api/devices.py","app/api/google.py","app/api/google_compat.py","app/api/google_oauth.py","app/api/google_services.py","app/api/ha.py","app/api/ha_local.py","app/api/health.py","app/api/health_google.py","app/api/history.py","app/api/integrations_status.py","app/api/logs_simple.py","app/api/me.py","app/api/memories.py","app/api/memory_ingest.py","app/api/metrics.py","app/api/metrics_root.py","app/api/models.py","app/api/music.py","app/api/music_http.py","app/api/music_provider.py","app/api/music_ws.py","app/api/oauth_apple.py","app/api/oauth_apple_stub.py","app/api/oauth_google.py","app/api/oauth_store.py","app/api/photos.py","app/api/preflight.py","app/api/profile.py","app/api/rag.py","app/api/reminders.py","app/api/root.py","app/api/schema.py","app/api/selftest.py","app/api/sessions.py","app/api/sessions_http.py","app/api/sessions_ws.py","app/api/settings.py","app/api/skills.py","app/api/sms_queue.py","app/api/spotify.py","app/api/spotify_player.py","app/api/spotify_sdk.py","app/api/status_plus.py","app/api/transcribe.py","app/api/tts.py","app/api/tv.py","app/api/tv_music_sim.py","app/api/util.py","app/api/voices.py","app/api/voices.py.bak","app/api/well_known.py","app/api/whoami.py","app/api/ws_endpoints.py","app/api/ws_helpers.py","app/audit.py","app/audit_legacy.py","app/audit_new/__init__.py","app/audit_new/models.py","app/audit_new/store.py","app/auth/__init__.py","app/auth/constants.py","app/auth.py","app/auth_core.py","app/auth_device/__init__.py","app/auth_monitoring.py","app/auth_protection.py","app/auth_providers.py","app/auth_refresh.py","app/auth_store.py","app/auth_store_tokens.py","app/bootstrap/router_contracts.py","app/bootstrap/router_registry.py","app/budget.py","app/capture.py","app/care_daemons.py","app/care_store.py","app/caregiver/__init__.py","app/chaos.py","app/config_docs.py","app/config_runtime.py","app/config_validator.py","app/cookie_config.py","app/cookie_names.py","app/cookies.py","app/cron/google_refresh.py","app/cron/spotify_refresh.py","app/crypto_tokens.py","app/csrf.py","app/custom_queue.py","app/db/__init__.py","app/db/config.py","app/db/dependencies.py","app/db/migrate.py","app/db/models.py","app/db/paths.py","app/db.py","app/decisions.py","app/deps/clerk_auth.py","app/deps/flags.py","app/deps/prompt_router.py","app/deps/roles.py","app/deps/scheduler.py","app/deps/scopes.py","app/deps/security_gates.py","app/deps/user.py","app/device_tokens.py","app/diagnostics/import_profile.py","app/diagnostics/startup_probe.py","app/diagnostics/state.py","app/domain/prompt_router.py","app/embeddings.py","app/env_utils.py","app/error_codes.py","app/error_envelope.py","app/error_handlers.py","app/errors.py","app/feature_flags.py","app/flags.py","app/follow_up.py","app/gpt_client.py","app/headers.py","app/health.py","app/health_utils.py","app/history.py","app/home_assistant.py","app/http_client.py","app/http_errors.py","app/http_utils.py","app/infra/__init__.py","app/infra/model_router.py","app/infra/oauth_monitor.py","app/infra/router_rules.py","app/ingest/markitdown_ingest.py","app/integrations/__init__.py","app/integrations/calendar_apple/__init__.py","app/integrations/calendar_fake/__init__.py","app/integrations/calendar_google/__init__.py","app/integrations/error_envelope.py","app/integrations/google/__init__.py","app/integrations/google/config.py","app/integrations/google/constants.py","app/integrations/google/db.py","app/integrations/google/errors.py","app/integrations/google/http_exchange.py","app/integrations/google/oauth.py","app/integrations/google/refresh.py","app/integrations/google/routes.py","app/integrations/google/services.py","app/integrations/google/state.py","app/integrations/logging_config.py","app/integrations/music_apple/__init__.py","app/integrations/photos_shared_album/__init__.py","app/integrations/spotify/__init__.py","app/integrations/spotify/budget.py","app/integrations/spotify/client.py","app/integrations/spotify/oauth.py","app/integrations/spotify/refresh.py","app/integrations/twilio_sms.py","app/intent_detector.py","app/jobs/__init__.py","app/jobs/ingest.py","app/jobs/migrate_chroma_to_qdrant.py","app/jobs/qdrant_lifecycle.py","app/llama_integration.py","app/llm_adapters.py","app/logging.py","app/logging_config.py","app/main.py","app/main.py.bak","app/memory/__init__.py","app/memory/api.py","app/memory/chroma_store.py","app/memory/env_utils.py","app/memory/memgpt/__init__.py","app/memory/memgpt/contracts/__init__.py","app/memory/memgpt/policy/__init__.py","app/memory/memgpt/summarizers/__init__.py","app/memory/memgpt.py","app/memory/memory_store.py","app/memory/models.py","app/memory/policy/__init__.py","app/memory/profile_store.py","app/memory/rerankers/base/__init__.py","app/memory/rerankers/hosted/__init__.py","app/memory/rerankers/local_cross_encoder/__init__.py","app/memory/rollups/__init__.py","app/memory/unified_store.py","app/memory/vector_store/__init__.py","app/memory/vector_store/base/__init__.py","app/memory/vector_store/chroma/__init__.py","app/memory/vector_store/dual/__init__.py","app/memory/vector_store/qdrant/__init__.py","app/memory/write_policy.py","app/metrics.py","app/metrics_auth.py","app/middleware/__init__.py","app/middleware/_cache.py","app/middleware/_trace_add.py","app/middleware/audit_mw.py","app/middleware/cors.py","app/middleware/cors_cache_fix.py","app/middleware/custom.py","app/middleware/deprecation_mw.py","app/middleware/error_handler.py","app/middleware/idempotency.py","app/middleware/loader.py","app/middleware/metrics_mw.py","app/middleware/middleware_core.py","app/middleware/rate_limit.py","app/middleware/session_attach.py","app/middleware/stack.py","app/migrations/001_create_third_party_tokens.sql","app/migrations/002_add_access_token_enc.sql","app/migrations/003_add_auth_identities.sql","app/migrations/004_enforce_identity_fk_and_not_null.sql","app/model_config.py","app/model_params.py","app/model_picker.py","app/model_router.py","app/models/__init__.py","app/models/common.py","app/models/music_state.py","app/models/third_party_tokens.py","app/models/tv.py","app/models/user.py","app/models/user_stats.py","app/music/__init__.py","app/music/circuit.py","app/music/errors.py","app/music/models.py","app/music/orchestrator.py","app/music/policy.py","app/music/providers/base.py","app/music/providers/home_assistant_radio.py","app/music/providers/librespot_provider.py","app/music/providers/spotify_provider.py","app/music/store.py","app/music/token_store.py","app/oauth_state.py","app/obs/ab/__init__.py","app/obs/events/__init__.py","app/obs/health/__init__.py","app/obs/metrics/__init__.py","app/observability.py","app/openapi/__init__.py","app/openapi/generator.py","app/openapi/schema.py","app/openapi.py","app/otel_utils.py","app/policy.py","app/postcall.py","app/proactive_engine.py","app/prompt_builder.py","app/queue/__init__.py","app/redaction.py","app/redirect_utils.py","app/retrieval/__init__.py","app/retrieval/diagnostics/__init__.py","app/retrieval/pipeline/__init__.py","app/retrieval/pipeline.py","app/retrieval/qdrant_hybrid.py","app/retrieval/qdrant_writer.py","app/retrieval/reranker.py","app/retrieval/strategies/__init__.py","app/retrieval/utils.py","app/router/__init__.py","app/router/admin_api.py","app/router/admin_extra_api.py","app/router/alias_api.py","app/router/ask_api.py","app/router/auth_api.py","app/router/auth_legacy_aliases.py","app/router/budget.py","app/router/calendar_api.py","app/router/compat.py","app/router/compat_api.py","app/router/config.py","app/router/contracts.py","app/router/entrypoint.py","app/router/google_api.py","app/router/handler.py","app/router/hooks.py","app/router/legacy_alias.py","app/router/model_router.py","app/router/music_api.py","app/router/policy.py","app/router/registry.py","app/router/rules_loader.py","app/router/state.py","app/router/transcribe_api.py","app/router/tts_api.py","app/router.py","app/router_policy.py","app/routers/__init__.py","app/routers/config.py","app/routers/dryrun_router.py","app/routers/llama_router.py","app/routers/openai_router.py","app/secret_verification.py","app/security/__init__.py","app/security/auth_contract.py","app/security/jwt_config.py","app/security/redirects.py","app/security/webhooks.py","app/security.py","app/security_ws.py","app/service_state.py","app/session_manager.py","app/session_store.py","app/sessions_store.py","app/settings.py","app/settings_cors.py","app/settings_rate.py","app/setup.sh","app/skills/__init__.py","app/skills/alarm_skill.py","app/skills/base.py","app/skills/calendar_skill.py","app/skills/checkin_skill.py","app/skills/climate_skill.py","app/skills/clock_skill.py","app/skills/color_skill.py","app/skills/confirmation_skill.py","app/skills/contracts.py","app/skills/cover_skill.py","app/skills/currency_skill.py","app/skills/datetime_skill.py","app/skills/day_summary_skill.py","app/skills/dictionary_skill.py","app/skills/door_lock_skill.py","app/skills/entities_skill.py","app/skills/explain_route_skill.py","app/skills/fan_skill.py","app/skills/forecast_skill.py","app/skills/joke_skill.py","app/skills/learners/alias_learner.py","app/skills/learners/schedule_learner.py","app/skills/ledger.py","app/skills/lights_skill.py","app/skills/math_eval.py","app/skills/math_skill.py","app/skills/medication_skill.py","app/skills/music_skill.py","app/skills/news_skill.py","app/skills/notes_skill.py","app/skills/notify_skill.py","app/skills/parsers.py","app/skills/password_skill.py","app/skills/policy.py","app/skills/recipe_skill.py","app/skills/regex_skill.py","app/skills/registry.py","app/skills/reminder_skill.py","app/skills/roku_skill.py","app/skills/routine_skill.py","app/skills/scene_skill.py","app/skills/script_skill.py","app/skills/search_skill.py","app/skills/selector.py","app/skills/shopping_list_skill.py","app/skills/smalltalk_skill.py","app/skills/sports_skill.py","app/skills/status_skill.py","app/skills/stock_skill.py","app/skills/suggestions_skill.py","app/skills/teach_skill.py","app/skills/text_utils_skill.py","app/skills/timer_skill.py","app/skills/traffic_skill.py","app/skills/translate_skill.py","app/skills/undo_skill.py","app/skills/unit_conversion_skill.py","app/skills/url_title_skill.py","app/skills/uuid_nanoid_skill.py","app/skills/uuid_skill.py","app/skills/vacuum_skill.py","app/skills/weather_skill.py","app/skills/world_clock_skill.py","app/slos.py","app/startup/__init__.py","app/startup/components.py","app/startup/config.py","app/startup/config_guard.py","app/startup/route_collision_guard.py","app/startup/vendor.py","app/status.py","app/storage.py","app/storytime.py","app/tasks.py","app/telemetry.py","app/token_budgeter.py","app/token_store.py","app/token_utils.py","app/tokens.py","app/transcribe.py","app/transcription.py","app/tts_orchestrator.py","app/ui_tv/__init__.py","app/ui_tv/screens/__init__.py","app/ui_tv/screens/cards/__init__.py","app/ui_tv/screens/cards/calendar.py","app/ui_tv/screens/cards/music.py","app/ui_tv/screens/cards/photos.py","app/ui_tv/screens/confirmation.py","app/ui_tv/screens/help.py","app/ui_tv/screens/home.py","app/ui_tv/screens/listening.py","app/ui_tv/screens/onboarding/__init__.py","app/ui_tv/screens/onboarding/stage1.py","app/ui_tv/screens/onboarding/stage2.py","app/ui_tv/screens/settings/__init__.py","app/ui_tv/screens/settings/granny_mode.py","app/ui_tv/state/__init__.py","app/ui_tv/state/store.py","app/ui_tv/widgets/__init__.py","app/ui_tv/widgets/big_buttons.py","app/ui_tv/widgets/caption_bar.py","app/ui_tv/widgets/media_player_overlay.py","app/ui_tv/widgets/tile_grid.py","app/ui_tv/widgets/yes_no_bar.py","app/url_helpers.py","app/user_store.py","app/utils/cache_async.py","app/vector_store.py","app/vector_store_main.py","app/voice/__init__.py","app/voice/input/__init__.py","app/voice/input/mic_controller.py","app/voice/input/ptt_driver.py","app/voice/input/vad.py","app/voice/input/wake_word.py","app/voice/nlp/__init__.py","app/voice/nlp/confirmation.py","app/voice/nlp/router.py","app/voice/stt/__init__.py","app/voice/stt/cloud_fallback.py","app/voice/stt/offline.py","app/voice/tts/__init__.py","app/voice/tts/engine.py","app/web/cookies.py","app/webhooks.py","app/ws_manager.py","app/ws_metrics.py","auth_csrf_audit.py","auth_probes.sh","authenticate.sh","bench/embed.py","check_api_routes.py","check_auth_logs.py","compare_routes.py","conftest.py","debug_auth_cookies.sh","demo_config_guard.py","demo_deprecations.py","dev/introspect_identity.py","diagnostic_test.js","docker-compose.librespot.yml","docker-compose.redis.yml","docker-compose.yml","dump_openapi.py","dump_routes.py","e2e/global-setup.ts","e2e/helpers/network-idle.ts","e2e/playwright/google_toggle.spec.ts","e2e/playwright.config.ts","e2e/tests/auth.spec.ts","e2e/tests/login-redirect.spec.ts","env.example","env.template","env_debugger.sh","frontend/.gitignore","frontend/e2e/auth-persists-after-reload.spec.ts","frontend/env.localhost","frontend/eslint.config.mjs","frontend/final_google_test.py","frontend/jest.config.js","frontend/jest.setup.ts","frontend/logs/backend.pid","frontend/next.config.js","frontend/postcss.config.js","frontend/public/apple-touch-icon.png","frontend/public/favicon.ico","frontend/public/file.svg","frontend/public/globe.svg","frontend/public/next.svg","frontend/public/placeholder.png","frontend/public/vercel.svg","frontend/public/window.svg","frontend/src/__tests__/BackendBanner.test.tsx","frontend/src/__tests__/DegradedNotice.test.tsx","frontend/src/__tests__/authBehavior.test.tsx","frontend/src/__tests__/authOrchestratorAuthGate.test.ts","frontend/src/__tests__/authOrchestratorAuthMismatchToast.test.ts","frontend/src/__tests__/authOrchestratorBootstrap.test.ts","frontend/src/__tests__/authOrchestratorOscillation.test.ts","frontend/src/__tests__/bootstrapManager.test.ts","frontend/src/__tests__/header-mode-credentials.test.ts","frontend/src/__tests__/ssr.test.tsx","frontend/src/__tests__/useBackendStatus.test.ts","frontend/src/__tests__/whoamiInterceptor.test.ts","frontend/src/app/(integrations)/integrations/page.tsx","frontend/src/app/(integrations)/spotify/connect/page.tsx","frontend/src/app/__tests__/layout.wshub.test.tsx","frontend/src/app/__tests__/logout.clerk.simple.test.tsx","frontend/src/app/__tests__/page.clerk.simple.test.tsx","frontend/src/app/__tests__/page.music_auth.test.tsx","frontend/src/app/__tests__/page.test.tsx","frontend/src/app/admin/__tests__/admin.page.test.tsx","frontend/src/app/admin/__tests__/tv-config.page.test.tsx","frontend/src/app/admin/ingest/page.tsx","frontend/src/app/admin/metrics/__tests__/metrics.page.test.tsx","frontend/src/app/admin/metrics/page.tsx","frontend/src/app/admin/page.tsx","frontend/src/app/admin/tv-config/page.tsx","frontend/src/app/capture/__tests__/capture.auth.test.tsx","frontend/src/app/capture/__tests__/capture.keyboard.test.tsx","frontend/src/app/capture/__tests__/capture.logic.test.tsx","frontend/src/app/capture/__tests__/capture.page.server.test.tsx","frontend/src/app/capture/__tests__/capture.provider.test.tsx","frontend/src/app/capture/__tests__/capture.recorder.test.tsx","frontend/src/app/capture/__tests__/capture.ui.test.tsx","frontend/src/app/capture/__tests__/capture.wsurl.test.tsx","frontend/src/app/capture/page.tsx","frontend/src/app/chat/page.tsx","frontend/src/app/debug/auth/page.tsx","frontend/src/app/debug/page.tsx","frontend/src/app/globals.css","frontend/src/app/layout.tsx","frontend/src/app/login/__tests__/login.oauth.test.tsx","frontend/src/app/login/__tests__/login.page.google.test.tsx","frontend/src/app/login/__tests__/login.page.test.tsx","frontend/src/app/login/__tests__/login.register.test.tsx","frontend/src/app/login/page.tsx","frontend/src/app/logout/page.tsx","frontend/src/app/onboarding/__tests__/onboarding.completeflow.test.tsx","frontend/src/app/onboarding/__tests__/onboarding.incomplete.test.tsx","frontend/src/app/onboarding/__tests__/onboarding.logic.test.tsx","frontend/src/app/onboarding/__tests__/onboarding.nav.test.tsx","frontend/src/app/onboarding/__tests__/onboarding.page.test.tsx","frontend/src/app/onboarding/__tests__/onboarding.redirects.test.tsx","frontend/src/app/onboarding/__tests__/onboarding.ui.test.tsx","frontend/src/app/onboarding/page.tsx","frontend/src/app/page.tsx","frontend/src/app/settings/Integrations/GoogleCard.tsx","frontend/src/app/settings/Integrations/GoogleManageDrawer.tsx","frontend/src/app/settings/SettingsLoading.tsx","frontend/src/app/settings/SettingsPageInner.tsx","frontend/src/app/settings/__tests__/settings.page.test.tsx","frontend/src/app/settings/__tests__/settings.preferences.test.tsx","frontend/src/app/settings/page.new.tsx","frontend/src/app/settings/page.tsx","frontend/src/app/sign-in/[[...sign-in]]/page.tsx","frontend/src/app/sign-up/[[...sign-up]]/page.tsx","frontend/src/app/test-cors/page.tsx","frontend/src/app/tv/__tests__/tv.ui.test.tsx","frontend/src/app/tv/calendar/__tests__/__snapshots__/calendar.page.test.tsx.snap","frontend/src/app/tv/calendar/__tests__/calendar.page.test.tsx","frontend/src/app/tv/calendar/page.tsx","frontend/src/app/tv/contacts/page.tsx","frontend/src/app/tv/listening/page.tsx","frontend/src/app/tv/live/__tests__/live.page.test.tsx","frontend/src/app/tv/live/__tests__/ticker.truncation.test.tsx","frontend/src/app/tv/live/page.tsx","frontend/src/app/tv/music/page.tsx","frontend/src/app/tv/onboarding/stage1/page.tsx","frontend/src/app/tv/onboarding/stage2/page.tsx","frontend/src/app/tv/page.tsx","frontend/src/app/tv/photos/page.tsx","frontend/src/app/tv/reminders/page.tsx","frontend/src/app/tv/settings/page.tsx","frontend/src/app/tv/spotify-player/page.tsx","frontend/src/app/tv/weather/page.tsx","frontend/src/components/AccountMismatchModal.tsx","frontend/src/components/AuthHUD.tsx","frontend/src/components/AuthProvider.tsx","frontend/src/components/BackendBanner.tsx","frontend/src/components/CaptureMode.tsx","frontend/src/components/ChatBubble.tsx","frontend/src/components/ClientOnly.tsx","frontend/src/components/ConfigValidator.tsx","frontend/src/components/DegradedNotice.tsx","frontend/src/components/EmptyState.tsx","frontend/src/components/FooterRibbon.tsx","frontend/src/components/GoogleSignInButton.tsx","frontend/src/components/Header.tsx","frontend/src/components/InputBar.tsx","frontend/src/components/IssueTray.tsx","frontend/src/components/LoadingBubble.tsx","frontend/src/components/ModelSelector.tsx","frontend/src/components/OnboardingFlow.tsx","frontend/src/components/ServiceChip.tsx","frontend/src/components/SessionBadge.tsx","frontend/src/components/StatusBanner.tsx","frontend/src/components/ThemeToggle.tsx","frontend/src/components/VoiceChip.tsx","frontend/src/components/WebSocketStatus.tsx","frontend/src/components/WsBootstrap.tsx","frontend/src/components/WsIndicator.tsx","frontend/src/components/__tests__/ChatBubble.test.tsx","frontend/src/components/__tests__/GoogleSignInButton.test.tsx","frontend/src/components/__tests__/Header.clerk.simple.test.tsx","frontend/src/components/__tests__/InputBar.test.tsx","frontend/src/components/__tests__/WebSocketStatus.test.tsx","frontend/src/components/music/DevicePicker.tsx","frontend/src/components/music/DiscoveryCard.tsx","frontend/src/components/music/MoodDial.tsx","frontend/src/components/music/NowPlayingCard.tsx","frontend/src/components/music/QueueCard.tsx","frontend/src/components/music/SpotifyControls.tsx","frontend/src/components/music/__tests__/discoverycard.subscribe.test.tsx","frontend/src/components/music/__tests__/queuecard.subscribe.test.tsx","frontend/src/components/onboarding/BasicInfoStep.tsx","frontend/src/components/onboarding/CompleteStep.tsx","frontend/src/components/onboarding/DevicePrefsStep.tsx","frontend/src/components/onboarding/IntegrationsStep.tsx","frontend/src/components/onboarding/PreferencesStep.tsx","frontend/src/components/onboarding/WelcomeStep.tsx","frontend/src/components/onboarding/__tests__/steps.ui.test.tsx","frontend/src/components/recorder/DevicePicker.tsx","frontend/src/components/recorder/LevelMeter.tsx","frontend/src/components/recorder/LiveTranscript.tsx","frontend/src/components/recorder/RecorderControls.tsx","frontend/src/components/recorder/RecorderProvider.tsx","frontend/src/components/recorder/SessionTimeline.tsx","frontend/src/components/recorder/__tests__/useRecorder.discipline.test.ts","frontend/src/components/recorder/useRecorder.ts","frontend/src/components/tv/BigButtons.tsx","frontend/src/components/tv/CaptionBar.tsx","frontend/src/components/tv/QuietHoursBadge.tsx","frontend/src/components/tv/YesNoBar.tsx","frontend/src/components/tv/layers/AlertLayer.tsx","frontend/src/components/tv/layers/VibeSwitcher.tsx","frontend/src/components/tv/layers/__tests__/alertlayer.test.tsx","frontend/src/components/tv/layers/__tests__/vibeswitcher.test.tsx","frontend/src/components/tv/surfaces/Backdrop.tsx","frontend/src/components/tv/surfaces/FooterRibbon.tsx","frontend/src/components/tv/surfaces/PrimaryStage.tsx","frontend/src/components/tv/surfaces/SideRail.tsx","frontend/src/components/tv/surfaces/__tests__/backdrop.test.tsx","frontend/src/components/tv/surfaces/__tests__/footerribbon.test.tsx","frontend/src/components/tv/surfaces/__tests__/primarystage.test.tsx","frontend/src/components/tv/surfaces/__tests__/siderail.test.tsx","frontend/src/components/tv/widgets/AlertPanel.tsx","frontend/src/components/tv/widgets/CalendarCard.tsx","frontend/src/components/tv/widgets/NowPlayingCard.tsx","frontend/src/components/tv/widgets/PhotoFrame.tsx","frontend/src/components/tv/widgets/TranscriptSlate.tsx","frontend/src/components/tv/widgets/VitalsBadge.tsx","frontend/src/components/tv/widgets/WeatherPeek.tsx","frontend/src/components/tv/widgets/__tests__/alertpanel.test.tsx","frontend/src/components/tv/widgets/__tests__/calendarcard.test.tsx","frontend/src/components/tv/widgets/__tests__/photoframe.test.tsx","frontend/src/components/tv/widgets/__tests__/transcriptslate.test.tsx","frontend/src/components/tv/widgets/__tests__/vitalsbadge.heartbeat.test.tsx","frontend/src/components/tv/widgets/__tests__/vitalsbadge.test.tsx","frontend/src/components/tv/widgets/__tests__/weatherpeek.test.tsx","frontend/src/components/ui/AuthErrorToast.tsx","frontend/src/components/ui/ToastManager.tsx","frontend/src/components/ui/__tests__/toast.test.tsx","frontend/src/components/ui/avatar.tsx","frontend/src/components/ui/badge.tsx","frontend/src/components/ui/button.tsx","frontend/src/components/ui/card.tsx","frontend/src/components/ui/skeleton.tsx","frontend/src/components/ui/textarea.tsx","frontend/src/components/ui/toast.tsx","frontend/src/config/features.ts","frontend/src/hooks/useAuth.ts","frontend/src/hooks/useAuthErrorHandler.ts","frontend/src/hooks/useAuthState.ts","frontend/src/hooks/useBackendStatus.ts","frontend/src/hooks/useBootstrap.ts","frontend/src/hooks/useDeterministicAuth.ts","frontend/src/hooks/useHealth.ts","frontend/src/hooks/useSpotify.ts","frontend/src/hooks/useWs.ts","frontend/src/lib/__tests__/api.ask.test.ts","frontend/src/lib/__tests__/api.auth.test.tsx","frontend/src/lib/__tests__/api.fetch.test.tsx","frontend/src/lib/__tests__/api.sse.test.ts","frontend/src/lib/__tests__/api.test.ts","frontend/src/lib/__tests__/api.ws.test.tsx","frontend/src/lib/__tests__/auth_epoch.test.ts","frontend/src/lib/__tests__/auth_epoch_cookie_mode.test.ts","frontend/src/lib/__tests__/csp.test.ts","frontend/src/lib/__tests__/features.test.ts","frontend/src/lib/__tests__/music_state_auth.test.ts","frontend/src/lib/__tests__/redirect-utils.test.ts","frontend/src/lib/__tests__/remoteKeymap.test.ts","frontend/src/lib/__tests__/uiEffects.test.ts","frontend/src/lib/__tests__/urls.test.ts","frontend/src/lib/__tests__/urls.websocket.test.ts","frontend/src/lib/__tests__/utils.test.ts","frontend/src/lib/__tests__/whoamiResilience.test.ts","frontend/src/lib/api/auth.ts","frontend/src/lib/api/base.ts","frontend/src/lib/api/fetch.ts","frontend/src/lib/api/hooks.ts","frontend/src/lib/api/integrations.ts","frontend/src/lib/api/routes.ts","frontend/src/lib/api/types.ts","frontend/src/lib/api/utils.ts","frontend/src/lib/api/websocket.ts","frontend/src/lib/api.ts","frontend/src/lib/api.ts.backup","frontend/src/lib/csp.ts","frontend/src/lib/features.ts","frontend/src/lib/parseEnvelope.ts","frontend/src/lib/queryClient.ts","frontend/src/lib/redirect-utils.ts","frontend/src/lib/redirects.ts","frontend/src/lib/remoteKeymap.ts","frontend/src/lib/toast.ts","frontend/src/lib/uiEffects.ts","frontend/src/lib/uiIntents.ts","frontend/src/lib/urls.ts","frontend/src/lib/utils.ts","frontend/src/lib/whoamiResilience.ts","frontend/src/middleware.ts","frontend/src/pages/_document.js","frontend/src/services/__tests__/authOrchestrator.whoamiDetection.test.ts","frontend/src/services/__tests__/scheduler.test.ts","frontend/src/services/__tests__/wsHub.discipline.test.ts","frontend/src/services/__tests__/wsHub.test.ts","frontend/src/services/auth/core.ts","frontend/src/services/auth/events.ts","frontend/src/services/auth/types.ts","frontend/src/services/auth/utils.ts","frontend/src/services/authOrchestrator.ts","frontend/src/services/bootstrapManager.ts","frontend/src/services/scheduler.ts","frontend/src/services/wsHub.ts","frontend/src/state/__tests__/sceneManager.test.ts","frontend/src/state/sceneManager.ts","frontend/src/state/widgetRegistry.ts","frontend/src/test_stubs/react-markdown.tsx","frontend/src/test_stubs/remark-gfm.ts","frontend/src/test_stubs/styleMock.js","frontend/tailwind.config.js","frontend/test-csp.js","frontend/tests/e2e/auth.spec.ts","generate_contracts.py","gesahni-clean.sh","gesahni-zshrc-config.sh","gesahni-zshrc-simple.sh","google_oauth_debugger.py","health","locustfile.py","logs/backend.log.backup","logs/backend.pid","logs/frontend.pid","logs/uvicorn.pid","manual_history_test.py","migrations/0002_dedupe_third_party_tokens.sql","migrations/env.py","migrations/versions/0001_bootstrap.py","monitor_auth_live.py","monitoring/Makefile","monitoring/alertmanager/alertmanager.yml","monitoring/cardinality_monitor.sh","monitoring/docker-compose.yml","monitoring/grafana/provisioning/dashboards/gesahni-dashboards.yaml","monitoring/grafana/provisioning/datasources/prometheus.yaml","monitoring/prometheus/alert_rules.yml","monitoring/prometheus/prometheus.yml","monitoring/prometheus/recording_rules.yml","monitoring/test-alerts.sh","monitoring/test-dashboard.sh","monitoring/test-slo.sh","monitoring/verify_smoke.sh","mypy.ini","next.config.mjs","oauth_probe.sh","parse_results.py","perf/k6/smoke.js","perf/locust/locustfile.py","playwright-report/index.html","prometheus-alerts.yml","prometheus-google-alerts.yml","pyproject.toml","pytest.ini","record_session.py","reproduce_auth_issue.html","route_analysis.py","route_security_matrix.py","router_rules.yaml","sdks/js-template/example.js","sdks/python-template/example.py","security/semgrep-rules/csrf-validation.yml","security/semgrep-rules/input-sanitization.yml","security/semgrep-rules/open-redirect.yml","security/semgrep-rules/rate-limiting.yml","serve_test_page.py","setup_test_db.py","simple_google_oauth_fix.html","simple_login.html","sitecustomize.py","smoke_check_security.sh","spotify_debugger.py","sqlite:/:memory:","test_curl_matrix.sh","test_deny_paths.sh","test_spotify_flow.sh","tests/__init__.py","tests/analytics.py","tests/chaos/__init__.py","tests/conftest.py","tests/helpers/auth.py","tests/helpers/http.py","tests/llama_integration.py","tests/smoke/__init__.py","tests/util_tokens.py","tests_summary.csv","third_party_tokens.db.bak","verify_auth_fix.js","verify_cookies.py","verify_google_oauth_ready.py","verify_header_auth.py","verify_oauth_fix.py","verify_security.sh","verify_security_proper.sh","web/src/app/layout.tsx","web/src/app/page.tsx","web/src/lib/queryClient.ts","web/src/styles/globals.css","web/src/tests/a11y.test.tsx"]},"time":{"rules":[],"rules_parse_time":0.6192989349365234,"profiling_times":{"config_time":3.0612499713897705,"core_time":16.90955901145935,"ignores_time":0.0009758472442626953,"total_time":19.97280788421631},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":156.2934443950653,"per_file_time":{"mean":0.059336918904732444,"std_dev":0.04589176189001348},"very_slow_stats":{"time_ratio":0.1845660988617424,"count_ratio":0.004555808656036446},"very_slow_files":[{"fpath":"app/api/ask.py","ftime":1.824859857559204},{"fpath":"frontend/src/components/recorder/useRecorder.ts","ftime":1.8743259906768799},{"fpath":"frontend/src/app/settings/SettingsPageInner.tsx","ftime":1.9639251232147217},{"fpath":"app/api/admin.py","ftime":2.2824079990386963},{"fpath":"app/main.py","ftime":2.2830169200897217},{"fpath":"app/router.py","ftime":2.6182851791381836},{"fpath":"app/auth_store_tokens.py","ftime":2.746124029159546},{"fpath":"app/api/google_oauth.py","ftime":3.108335018157959},{"fpath":"app/api/auth.py","ftime":3.1767120361328125},{"fpath":"app/security.py","ftime":3.433425188064575}]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[{"error_type":"Fixpoint timeout","severity":"warn","message":"Fixpoint timeout while performing taint analysis at app/api/google_oauth.py:404:10 [rules: 3, first: python.boto3.security.hardcoded-token.hardcoded-token]","location":{"path":"app/api/google_oauth.py","start":{"line":404,"col":11,"offset":13473},"end":{"line":404,"col":26,"offset":13488}}},{"error_type":"Fixpoint timeout","severity":"warn","message":"Fixpoint timeout while performing taint analysis at app/api/spotify.py:592:10 [rules: 1, first: python.boto3.security.hardcoded-token.hardcoded-token]","location":{"path":"app/api/spotify.py","start":{"line":592,"col":11,"offset":20505},"end":{"line":592,"col":27,"offset":20521}}},{"error_type":"Fixpoint timeout","severity":"warn","message":"Fixpoint timeout while performing taint analysis at app/auth_store_tokens.py:240:14 [rules: 1, first: python.boto3.security.hardcoded-token.hardcoded-token]","location":{"path":"app/auth_store_tokens.py","start":{"line":240,"col":15,"offset":10977},"end":{"line":240,"col":27,"offset":10989}}},{"error_type":"Fixpoint timeout","severity":"warn","message":"Fixpoint timeout while performing taint analysis at app/main.py:280:10 [rules: 1, first: python.boto3.security.hardcoded-token.hardcoded-token]","location":{"path":"app/main.py","start":{"line":280,"col":11,"offset":8590},"end":{"line":280,"col":28,"offset":8607}}},{"error_type":"Fixpoint timeout","severity":"warn","message":"Fixpoint timeout while performing taint analysis at app/memory/unified_store.py:75:4 [rules: 1, first: python.boto3.security.hardcoded-token.hardcoded-token]","location":{"path":"app/memory/unified_store.py","start":{"line":75,"col":5,"offset":2337},"end":{"line":75,"col":24,"offset":2356}}},{"error_type":"Fixpoint timeout","severity":"warn","message":"Fixpoint timeout while performing taint analysis at app/middleware/middleware_core.py:377:14 [rules: 1, first: python.boto3.security.hardcoded-token.hardcoded-token]","location":{"path":"app/middleware/middleware_core.py","start":{"line":377,"col":15,"offset":15648},"end":{"line":377,"col":23,"offset":15656}}},{"error_type":"Fixpoint timeout","severity":"warn","message":"Fixpoint timeout while performing taint analysis at demo_config_guard.py:11:4 [rules: 1, first: python.boto3.security.hardcoded-token.hardcoded-token]","location":{"path":"demo_config_guard.py","start":{"line":11,"col":5,"offset":241},"end":{"line":11,"col":22,"offset":258}}},{"error_type":"Fixpoint timeout","severity":"warn","message":"Fixpoint timeout while performing taint analysis at monitor_auth_live.py:28:4 [rules: 1, first: python.boto3.security.hardcoded-token.hardcoded-token]","location":{"path":"monitor_auth_live.py","start":{"line":28,"col":5,"offset":585},"end":{"line":28,"col":17,"offset":597}}},{"error_type":"Fixpoint timeout","severity":"warn","message":"Fixpoint timeout while performing taint analysis at verify_cookies.py:15:4 [rules: 1, first: python.boto3.security.hardcoded-token.hardcoded-token]","location":{"path":"verify_cookies.py","start":{"line":15,"col":5,"offset":285},"end":{"line":15,"col":9,"offset":289}}}],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.980549175193151,"rules_selected_ratio":0.05644184589684694,"rules_matched_ratio":0.05644184589684694},"targets":[],"total_bytes":0,"max_memory_bytes":408032896},"engine_requested":"OSS","skipped_rules":[]}
